{
    "problem_code": "CIELWEB",
    "problem_author": "laycurse",
    "contest_name": "March Cook-Off 2012",
    "todo": false,
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;</span><span>laycurse</span>",
    "problem_name": "Ciel and Communications System",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;</span><span>rajivka</span>",
    "contest_code": "COOK20",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/cook20'>cook20</a>, <a class='problem-tag-small ' href='/tags/problems/hard'>hard</a>, <a class='problem-tag-small ' href='/tags/problems/laycurse'>laycurse</a>",
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><p>\nCiel has <strong>N</strong> restaurants on a long straight road.\nThe coordinate of the <strong>i</strong>-th restaurant is <strong>X<sub>i</sub></strong>, and <strong>X</strong><sub>1</sub> \u2264 <strong>X</strong><sub>2</sub> \u2264 ...  \u2264 <strong>X<sub>N</sub></strong>.\nNote that more than one restaurant can have the same coordinate. (They may be in the same building.)\n</p>\n\n<p>\nWhen the <strong>i</strong>-th restaurant communicates with the <strong>j</strong>-th restaurant (<strong>i</strong> &lt; <strong>j</strong>), a bit strange method is used.\nIn the method, some towers are used.\nEach tower <strong>t</strong> has four parameters <strong>Y</strong>[<strong>t</strong>], <strong>R</strong>[<strong>t</strong>], <strong>C</strong>[<strong>t</strong>] and <strong>T</strong>[<strong>t</strong>].\nHere <strong>Y</strong>[<strong>t</strong>] denotes the coordinate of the tower, <strong>R</strong>[<strong>t</strong>] denotes the range of the tower, <strong>C</strong>[<strong>t</strong>] denotes the cost for using the tower if the distance between the tower and the restaurant is 1, and <strong>T</strong>[<strong>t</strong>] denotes the type of the tower.\nThe <strong>i</strong>-th restaurant can use the tower <strong>t</strong> if and only if |<strong>X<sub>i</sub></strong> - <strong>Y</strong>[<strong>t</strong>]| \u2264 <strong>R</strong>[<strong>t</strong>].\nHere <strong>T</strong>[<strong>t</strong>] is represented as an integer 1 \u2264 <strong>T</strong>[<strong>t</strong>] \u2264 <strong>M</strong>, where <strong>M</strong> is the number of types.\n</p>\n\n<p>\nFor some security reasons, the <strong>k</strong>-th restaurant can communicate with only the (<strong>k</strong>\u00b11)-th restaurant directly.\nSo, it is necessary that the <strong>k</strong>-th restaurant communicates with the (<strong>k</strong>+1)-th restaurant for all <strong>i</strong> \u2264 <strong>k</strong> &lt; <strong>j</strong>.\nFor each communication between the <strong>k</strong>-th and (<strong>k</strong>+1)-th restaurants, each restaurant chooses the newest available tower.\nLet <strong>TOWER<sub>k</sub></strong> be the newest available tower for the <strong>k</strong>-th restaurant, and let <strong>TYPE</strong>[<strong>k</strong>] be the type of <strong>TOWER<sub>k</sub></strong>.\nThe cost for the communication is <strong>C</strong>[<strong>TOWER<sub>k</sub></strong>] * |<strong>Y</strong>[<strong>TOWER<sub>k</sub></strong>] - <strong>X</strong><sub><strong>k</strong></sub>| + <strong>C</strong>[<strong>TOWER</strong><sub><strong>k</strong>+1</sub>]  * |<strong>Y</strong>[<strong>TOWER</strong><sub><strong>k</strong>+1</sub>] - <strong>X</strong><sub><strong>k</strong>+1</sub>|.\nIf <strong>TOWER<sub>k</sub></strong> \u2260 <strong>TOWER</strong><sub><strong>k</strong>+1</sub>, then additionally the cost <strong>U</strong><sub><strong>TYPE</strong>[<strong>k</strong>], <strong>TYPE</strong>[<strong>k</strong>+1]</sub> is needed.\nThe total cost of the communication between the <strong>i</strong>-th and <strong>j</strong>-th restaurants is the sum of the cost of the communication between the <strong>k</strong>-th and (<strong>k</strong>+1)-th restaurants over all <strong>i</strong> \u2264 <strong>k</strong> &lt; <strong>j</strong>.\nIf there should exist some <strong>i</strong> \u2264 <strong>k</strong> \u2264 <strong>j</strong> such that the <strong>k</strong>-th restaurant has no available towers, the communication is impossible.\n</p>\n\n<p>\nNow Ciel has the history of communications and constructions of towers.\nYour task is to calculate the cost for each communication in the history.\nIn the beginning of the history, you should assume that there are no towers.\n</p>\n\n<h3>Input</h3>\n<p>\nThe first line contains an integer <strong>N</strong>, <strong>M</strong> and <strong>Q</strong>, where <strong>Q</strong> denotes the number of the lines of the history.\nThen next line contains <strong>N</strong> integers, where the <strong>i</strong>-th integer denotes <strong>X<sub>i</sub></strong>.\nThen next <strong>M</strong> lines contain <strong>M</strong> integers, where the <strong>j</strong>-th integer of the <strong>i</strong>-th line denotes <strong>U</strong><sub><strong>i</strong>,<strong>j</strong></sub>\nThen next <strong>Q</strong> lines denote the history of communications and constructions.\nThe history is composed of the two types of lines.\nThe line \"1 <strong>A</strong> <strong>B</strong>\" (without quotes) means that the <strong>A</strong>-th restaurant communicates with the <strong>B</strong>-th restaurant.\nThe line \"2 <strong>Y</strong> <strong>R</strong> <strong>C</strong> <strong>T</strong>\" (without quotes) means that the tower whose parameters are <strong>Y</strong>, <strong>R</strong>, <strong>C</strong> and <strong>T</strong> is built.\n</p>\n\n<h3>Output</h3>\n<p>\nFor each communication, print the cost.\nIf it is impossible, print \"impossible\" without quotes.\n</p>\n\n<h3>Constraints</h3>\n<p>\n2 \u2264 <strong>N</strong> \u2264 100000 (10<sup>5</sup>)<br />\n1 \u2264 <strong>M</strong> \u2264 50<br />\n1 \u2264 <strong>Q</strong> \u2264 50000 (5 * 10<sup>4</sup>)<br />\n0 \u2264 <strong>X</strong><sub>1</sub> \u2264 <strong>X</strong><sub>2</sub> \u2264 ... \u2264 <strong>X<sub>N</sub></strong> \u2264 1000000000 (10<sup>9</sup>)<br />\n0 \u2264 <strong>U</strong><sub><strong>i</strong>,<strong>j</strong></sub> \u2264 1000000000 (10<sup>9</sup>)<br />\n1 \u2264 <strong>A</strong> &lt; <strong>B</strong> \u2264 <strong>N</strong><br />\n0 \u2264 <strong>Y</strong> \u2264 1000000000 (10<sup>9</sup>)<br />\n1 \u2264 <strong>R</strong> \u2264 1000000000 (10<sup>9</sup>)<br />\n1 \u2264 <strong>C</strong> \u2264 10000 (10<sup>4</sup>)<br />\n1 \u2264 <strong>T</strong> \u2264 <strong>M</strong><br />\n<strong>U</strong><sub><strong>i</strong>,<strong>j</strong></sub> = <strong>U</strong><sub><strong>j</strong>,<strong>i</strong></sub><br />\n</p>\n\n<h3>Sample Input</h3>\n<pre>5 2 6\n1 3 5 7 10\n1 3\n3 1\n1 1 2\n2 5 5 1 1\n1 1 2\n1 1 4\n2 4 1 2 1\n1 1 4</pre>\n\n<h3>Sample Output</h3>\n<pre>impossible\n6\n10\n16</pre>",
    "category_name": "main",
    "date_added": "27-02-2012",
    "status": "success",
    "languages_supported": "C, JAVA, PYTH, PYTH 3.6, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, CLOJ, FS",
    "max_timelimit": "0.432806",
    "problem_status": "unattempted",
    "editorial_url": "http://discuss.codechef.com/problems/CIELWEB",
    "problem_tester": "rajivka",
    "time": {
        "view_start_date": 1332086400,
        "end_date": 1332095400,
        "practice_submission_allowed": true,
        "visible_start_date": 1332095400,
        "submit_start_date": 1332086400,
        "current": 1537438863
    },
    "user": {
        "username": ""
    }
}