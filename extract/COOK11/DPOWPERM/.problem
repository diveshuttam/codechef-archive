{
    "problem_code": "DPOWPERM",
    "problem_author": "anton_lunyov",
    "contest_name": "June Cook-off",
    "todo": false,
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;</span><span>anton_lunyov</span>",
    "problem_name": "D-Power Permutations",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;</span><span>rajivka</span>",
    "contest_code": "COOK11",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/anton_lunyov'>anton_lunyov</a>, <a class='problem-tag-small ' href='/tags/problems/cook11'>cook11</a>, <a class='problem-tag-small ' href='/tags/problems/hard'>hard</a>",
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><p>\nLet <b>N</b> be a positive integer and <b>S = {1, 2, 3, ..., N}</b>. For a given positive integer <b>d</b> the function <b>f : S --&gt; S</b> is called <b>d</b>-power permutation if there exists a bijection <b>g : S --&gt; S</b> such that <b>g ( g ( ... g ( x ) ... ) ) = f(x)</b> for each <b>x</b> from <b>S</b> , where <b>g</b> is repeated exactly <b>d</b> times.\n</p><p></p><p>\nYou are given some bijection <b>f : S --&gt; S</b> and a positive integer <b>D</b>. You need to find the number of those <b>d &lt;= D</b> such that <b>f</b> is <b>d</b>-power permutation.\n\n<h3>Input</h3>\n</p><p> The first line contains a single positive integer <b>T &lt;= 10</b>, the number of test cases. <b>T</b> test cases follow. The first line of each test case contains two positive integers <b>N</b> and <b>D</b>, where <b>N &lt;= 700</b> and <b>D &lt;= 10<sup>18</sup></b>. The second line contains <b>N</b> space-separated integers. <b>i</b><sup>th</sup> number in the second line is the value <b>f(i)</b>. It is guaranteed that <b>f</b> is bijection from <b>S</b> onto <b>S</b>.\n\n<h3>Output</h3>\n</p><p> For each test case, output a single line containing the answer for the corresponding test case.\n\n<h3>Example</h3>\n<pre>\n<b>Input:</b>\n2\n3 6\n1 2 3\n5 10\n2 1 4 5 3\n\n<b>Output:</b>\n6\n3\n</pre>\n\n<h3>Explanation</h3>\nIn the second case the appropriate values of <b>d</b> is 1, 5 and 7.</p>",
    "category_name": "main",
    "date_added": "11-06-2011",
    "status": "success",
    "languages_supported": "C, JAVA, PYTH, PYTH 3.6, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, CLOJ, FS",
    "max_timelimit": "0.52",
    "problem_status": "unattempted",
    "editorial_url": "http://discuss.codechef.com/problems/DPOWPERM",
    "problem_tester": "rajivka",
    "time": {
        "view_start_date": 1308499200,
        "end_date": 1308508200,
        "practice_submission_allowed": true,
        "visible_start_date": 1308508200,
        "submit_start_date": 1308499200,
        "current": 1537439189
    },
    "user": {
        "username": ""
    }
}