{
    "problem_code": "SPECIES",
    "problem_author": "errichto",
    "contest_name": "March Lunchtime 2017",
    "todo": false,
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;</span><span>errichto</span>",
    "problem_name": "Bear and Species",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;</span><span>kingofnumbers</span>",
    "contest_code": "LTIME46",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/dfs'>dfs</a>, <a class='problem-tag-small ' href='/tags/problems/errichto'>errichto</a>, <a class='problem-tag-small ' href='/tags/problems/flood_fill_algorithm'>flood_fill_algorithm</a>, <a class='problem-tag-small ' href='/tags/problems/graph'>graph</a>, <a class='problem-tag-small ' href='/tags/problems/ltime46'>ltime46</a>, <a class='problem-tag-small ' href='/tags/problems/simple'>simple</a>",
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><h3> Read problems statements in <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/LTIME46/mandarin/SPECIES.pdf\">Mandarin Chinese</a>, <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/LTIME46/russian/SPECIES.pdf\">Russian</a> and <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/LTIME46/vietnamese/SPECIES.pdf\">Vietnamese</a> as well.</h3>\n\n\n<p>\nBearland can be represented as a square grid that consists of <b>N</b> rows and <b>N</b> columns.\nTwo cells are called adjacent if they share a side.\nIn the input, each cell is described by one character:\n</p>\n\n<ul>\n<li>'.' is an empty cell.</li>\n<li>'B', 'G' or 'P' is a cell inhabited by bears of one species \u2014 brown, grizzly or polar bears respectively.</li>\n<li>'?' is a cell inhabited by bears of one species but you don't know which one.\nNote that this cell can't be empty.</li>\n</ul>\n\n<p>Grizzly bears are the most aggressive species.\nIf a cell is inhabited by grizzly bears, all adjacent cells should be empty, because otherwise there would be fights between bears.</p>\n\n<p>Brown and polar bears are a bit calmer.\nAll brown bears are fine with other brown bears in adjacent cells, but they would fight with bears of any other species.\nSimilarly, polar bears would fight with bears of any species other than polar bears.</p>\n\n<p>Let X denote the number of question marks.\nSince each question mark represents one of the three species, there are 3<sup>X</sup> ways to replace them with characters 'B', 'G' and 'P' (denoting the species that live in that cell).\nFind the number of such ways that there are no fights between bears.\nPrint the answer modulo (10<sup>9</sup>+7).</p>\n\n\n\n\n<h3>Input</h3>\n\n<p>The first line of the input contains an integer <b>T</b> denoting the number of test cases. The description of <b>T</b> test cases follows.</p>\n\n<p>\nThe first line of each test case contains an integer <b>N</b> denoting the size of the grid.\n</p>\n\n<p>The following <b>N</b> lines describe the grid.\nEach of those lines contains a string of length <b>N</b>.\nEach character is one of five: '.', '?', 'B', 'G', 'P'.\n\n\n\n<h3>Output</h3>\n\n<p>For each test case, output a single line containing one integer \u2014 the number of ways to replace question marks to avoid fights in Bearland, modulo (10<sup>9</sup>+7).</p>\n\n\n\n<h3>Constraints</h3>\n<ul>\n<li>1 \u2264 <b>T</b> \u2264 50</li>\n<li>2 \u2264 <b>N</b> \u2264 50</li>\n</ul>\n\n<h3>Subtasks</h3>\n<ul>\n<li>Subtask #1 (30 points): 2 \u2264 <b>N</b> \u2264 3</li>\n<li>Subtask #2 (30 points): Each character in the grid will be either '.' or '?'.</li>\n<li>Subtask #3 (40 points): Original constraints.</li>\n</ul>\n\n\n<h3>Example</h3>\n<pre><b>Input:</b>\n<code>6\n3\n..?\n.?B\nG..\n2\nGG\n..\n3\n?..\n.??\n??.\n3\n??P\n???\n??B\n7\n?.?.?.?\n.?.?.?.\n?.?.?.?\n.?.?.?.\n?.?.?.?\n.?.?.?.\n?.?.?.?\n2\nPP\nPP</code>\n\n<b>Output:</b>\n1\n0\n6\n0\n288603514\n1\n</pre>\n\n\n\n<h3>Explanation</h3>\n\n<p><b>Test case 1.</b> We are given the grid of size 3 \u00d7 3. One of the already fixed cells is inhabited by brown bears. They would fight with bears of any species other than brown bears, so adjacent cells with question marks must by inhabited by brown bears as well.\nHence, there is only 1 way to replace question marks (both of them must be replaced by 'B').</p>\n\n<p><b>Test case 2.</b> In the given grid, there are two adjacent cells both inhabited by grizzly bears.\nThey will fight with each other, so the answer is 0 \u2014 it's impossible to replace question marks so that there would be no fights (it doesn't matter that there are no question marks at all).</p>\n\n<p><b>Test case 3.</b> There are 6 ways:</p>\n\n<pre><code>B.. B.. G.. G.. P.. P..\n.BB .PP .BB .PP .BB .PP\nBB. PP. BB. PP. BB. PP.</code></pre>\n\n<br>\n\n\n<p><b>Test case 4.</b> No matter how we replace question marks, bears in some two adjacent cells will start a fight.\nThe answer is 0.</p>",
    "category_name": "main",
    "date_added": "24-03-2017",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS",
    "max_timelimit": "1",
    "problem_status": "unattempted",
    "editorial_url": "https://discuss.codechef.com/problems/SPECIES",
    "problem_tester": "kingofnumbers",
    "time": {
        "view_start_date": 1490450400,
        "end_date": 1490461200,
        "practice_submission_allowed": true,
        "visible_start_date": 1490461200,
        "submit_start_date": 1490450400,
        "current": 1537433969
    },
    "user": {
        "username": ""
    }
}