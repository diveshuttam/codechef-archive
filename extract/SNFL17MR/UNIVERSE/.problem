{
    "status": "success",
    "problem_status": "unattempted",
    "problem_tester": null,
    "body": "<h3> Read problems statements in <a target=\"_blank\" \nhref=\"http://www.codechef.com/download/translated/SNCKFL17/mandarin/UNIVERSE.pdf\">Mandarin Chinese</a>, <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/SNCKFL17/russian/UNIVERSE.pdf\">Russian</a> and <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/SNCKFL17/vietnamese/UNIVERSE.pdf\">Vietnamese</a> as well.</h3>\n\n<p>Welcome to the year 3017! Things have changed a lot in the last thousand years. Now people don't live only on the Earth. They live in many planets. And even more amazingly, they also live in many parallel universes which were discovered!</p>\n\n<p>There is an infinite number of parallel universes, each of which has <b>N</b> planets. The planets inside a single universe are numbered from 1 to <b>N</b>. The planets inside a single universe are connected with each other by <b>N-1</b> bi-directional tunnels in such a way that there's a path between any pair of planets within a single universe. The network of tunnels in every universe is the same. That is, if there is a tunnel between planets q<sub>1</sub> and q<sub>2</sub> in some universe, then there is a tunnel between planets q<sub>1</sub> and q<sub>2</sub> in every universe.</p>\n\n<p>The universes are numbered starting from 1, while the planets in a single universe are numbered from 1 to <b>N</b>. Therefore a particular planet can be uniquely determined by its planet number inside the particular universe, and the number of the universe that it belongs to.</p>\n\n<p>There are also <b>M</b> special bi-directional teleports that let you travel from one planet to another, and these could even be across different universes. Each teleport is defined by 4 numbers, <b>p<sub>1</sub>, u<sub>1</sub>, p<sub>2</sub>, u<sub>2</sub></b>. This means that it can teleport you from the <b>p<sub>1</sub></b>-th planet in <b>u<sub>1</sub></b>-th universe to the <b>p<sub>2</sub></b>-th planet in <b>u<sub>2</sub></b>-th universe and also vice-versa. </p>\n\n<p>All tunnels and special teleports take 1 unit of time to pass through.</p>\n\n<p>Chef wants to find the shortest distance between two places. He has <b>Q</b> such queries that need to be answered. Try to help him with these.</p>\n\n<h3>Input</h3>\n<p>The first line contains three integers, <b>N</b>, <b>M</b> and <b>Q</b>, which denote the number of planets in a single universe, the number of special teleports, and the number of queries, respectively.</p>\n\n<p>The next <b>N</b> - 1 lines describe the tunnels which connect planets inside a universe. Each line has two integers denoting the labels of the planets connected by the tunnel.</p>\n\n<p>The next <b>M</b> lines describe the special teleports, with each line containing 4 integers: <b>p<sub>1</sub>, u<sub>1</sub>, p<sub>2</sub>, u<sub>2</sub></b> as described above.</p>\n\n<p>The next <b>Q</b> lines describe the queries. Each line contains four integers <b>p<sub>1</sub>, u<sub>1</sub>, p<sub>2</sub>, u<sub>2</sub></b>, and this means that you have to find the length of a shortest path between the <b>p<sub>1</sub></b>-th planet in <b>u<sub>1</sub></b>-th universe and the <b>p<sub>2</sub></b>-th planet in <b>u<sub>2</sub></b>-th universe.</p>\n\n<h3>Output</h3>\n<p>For each query output its answer in a new line. If it's possible to reach one planet from the other, then output the shortest distance between them. Otherwise, output \"impossible\". (without quotes)\n</p>\n\n<h3>Constraints</h3>\n<ul>\n<li>1 \u2264 <b>N</b> \u2264 300,000</li>\n<li>1 \u2264 <b>M</b> \u2264 100,000</li>\n<li>1 \u2264 <b>Q</b> \u2264 10</li>\n<li>1 \u2264 <b>p<sub>1</sub></b>, <b>p<sub>2</sub></b> \u2264 <b>N</b></li>\n<li>1 \u2264 <b>u<sub>1</sub></b>, <b>u<sub>2</sub></b> \u2264 200,000</li>\n<li>The whole graph (including both tunnels and special teleports) has no multi-edges or loops.\n<p>That is, for every four valid integers a, b, c, d, there is <b>at most</b> one direct connection (ie. a tunnel or a special teleport) between the a-th planet in the b-th universe and the c-th planet in the d-th universe. Also, if there is a direct connection then a \u2260 c or b \u2260 d.</p>\n</li>\n</ul>\n\n<h3>Example</h3>\n<pre><b>Input1:</b>\n3 3 3\n1 2\n2 3\n1 1 1 2\n3 3 3 2\n1 2 3 3\n2 1 2 2\n2 1 2 3\n1 2 3 2\n\n<b>Output1:</b>\n3\n4\n2\n\n</pre>\n\n<p><b>Explanation 1</b>: There are <b>N</b> = 3 planets in each universe. And they are connected by the edges (1, 2) and (2, 3) in each universe, as described by the 2nd and 3rd lines of the input. There are <b>M</b> = 3 special teleports, which are described by the 4th, 5th and 6th lines of the input. For example, the fourth line is \"1 1 1 2\", which means that there is a special teleport between the first planet of the first universe and the first planet of the second universe. The next <b>Q</b> = 3 lines denote the queries. For example, the 7th line is \"2 1 2 2\", which asks for the shortest distance between the second planet of the first universe and the second planet of the second universe.</p>\n<p>The map of the multi-verse would look like this:</p>\n<p></p>\n<img src=\"https://codechef_shared.s3.amazonaws.com/download/upload/SNCKFL17/universe.png\" height=\"200\"/>\n<p></p>\n<p>The solid lines correspond to tunnels, and the dotted lines correspond to the special teleports.</p>\n\n<p>In the first query, we need to find the length of a shortest path between the second planet in the first universe and the second planet in the second universe. If we are starting from the second planet in the first universe, we can go to the first planet in the first universe in 1 unit of time using the tunnel. Then we can use the special teleport to go to the first planet in the second universe, and this will take another 1 unit of time. Finally, we can use a tunnel to go to the second planet in the second universe, in another 1 unit of time. The total time needed was 3, and we cannot do better than this. Hence, the answer is 3.</p>\n\n<p>In the second query, we need to find the length of a shortest path between the second planet in the first universe and the second planet in the third universe. The answer is 4.</p>\n\n<p>In the third query, we need to find the length of a shortest path between the first planet in the second universe and the third planet in the second universe. The answer is 2.</p>\n\n<pre><b>Input2:</b>\n4 1 8\n1 2\n1 3\n3 4\n1 30 4 30\n1 30 3 30\n1 30 4 30\n1 53 3 30\n1 53 4 30\n1 13 2 30\n1 30 3 14\n2 14 4 14\n2 30 4 30\n\n<b>Output2:</b>\n1\n1\nimpossible\nimpossible\nimpossible\nimpossible\n3\n2\n\n</pre>\n\n<p><b>Explanation 2</b>: Note that there can be teleports between two planets of the same universe. As example, the only teleport in this testcase is between the first and fourth planets of the 30<sup>th</sup> universe.</p>",
    "category_name": "main",
    "user": {
        "username": ""
    },
    "date_added": null,
    "is_direct_submittable": false,
    "contest_name": "SnackDown 2017 Onsite Final Mirror",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS",
    "todo": false,
    "time": {
        "view_start_date": 1498892400,
        "end_date": 1498910400,
        "practice_submission_allowed": true,
        "visible_start_date": 1809931733,
        "submit_start_date": 1498892400,
        "current": 1537433750
    },
    "problem_author_html_handle": null,
    "problem_name": "Year 3017",
    "source_sizelimit": "50000",
    "tags": "<a class='problem-tag-small ' href='/tags/problems/kingofnumbers'>kingofnumbers</a>",
    "problem_tester_html_handle": null,
    "problem_author": null,
    "contest_code": "SNFL17MR",
    "max_timelimit": "7",
    "problem_code": "UNIVERSE"
}