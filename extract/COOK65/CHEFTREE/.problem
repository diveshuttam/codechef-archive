{
    "problem_code": "CHEFTREE",
    "problem_author": "mgch",
    "contest_name": "December Cook-Off 2015",
    "todo": false,
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;</span><span>mgch</span>",
    "problem_name": "Chef and Tree",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "",
    "contest_code": "COOK65",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/cook65'>cook65</a>, <a class='problem-tag-small ' href='/tags/problems/data-structure'>data-structure</a>, <a class='problem-tag-small ' href='/tags/problems/hard'>hard</a>, <a class='problem-tag-small ' href='/tags/problems/heavy-light'>heavy-light</a>, <a class='problem-tag-small ' href='/tags/problems/mgch'>mgch</a>, <a class='problem-tag-small ' href='/tags/problems/segment-tree'>segment-tree</a>",
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><h3> Read problems statements in <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/COOK65/mandarin/CHEFTREE.pdf\">Mandarin Chinese</a>, <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/COOK65/russian/CHEFTREE.pdf\">Russian</a> and <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/COOK65/vietnamese/CHEFTREE.pdf\">Vietnamese</a> as well.</h3>\n\n\n<p>\nChef has a tree on <b>N</b> nodes. Each node <b>v</b> has an integer label <b>C<sub>v</sup></b> attached to it. Chef also has two other integers, <b>A</b> and <b>B</b>. He needs to run <b>Q</b> queries on the tree, each of which can be one of the following two types:\n<li>1 <b>u</b> <b>v</b> <b>w</b> \u2014 add <b>w</b> to the labels of all vertices which lie on a simple path between nodes <b>u</b> and <b>v</b>.</li>\n<li>2 <b>u</b> <b>v</b> \u2014 find the number of vertices <b>x</b> on a simple path between <b>u</b> and <b>v</b> for which <b>A</b>*<b>C<sub>x</sub></b> + <b>B</b> \u2265 0.</li>\n</p>\n<p>\nPlease help Chef run these queries.\n</p>\n\n<h3>Input</h3>\nThe first line of input contains an integer <b>T</b> denoting the number of test cases. \n<li>The first line of each test case contains two positive numbers: <b>N</b> and <b>Q</b>.</li>\n<li>The second line of each test case contains two positive numbers <b>A</b> and <b>B</b>.</li>\n<li>The third line of each test case contains <b>N</b> integers \u2014 <b>C<sub>1</sub></b>, <b>C<sub>2</sub></b>, ... , <b>C<sub>N</sub></b> \u2014 labels of the nodes.</li>\n<li>The next <b>N - 1</b> lines contain two integers <b>u</b>, <b>v</b> each, denoting a pair vertices connected by an edge. </li>\n<li>The following <b>Q</b> lines contains queries.</li>\n\n<h3>Output</h3>\nFor each query of the second type, output a single line containing a single integer \u2014 its result.\n\n<h3>Constraints</h3>\n<ul>\n<li>1 \u2264 <b>T</b> \u2264 10<sup>5</sup></li>\n<li>1 \u2264 <b>N, Q</b> \u2264 10<sup>5</sup></li>\n<li>1 \u2264 <b>u, v</b> \u2264 <b>N</b></li>\n<li>0 \u2264 <b>A</b>, |<b>B</b>|, |<b>C<sub>i</sub></b>| \u2264 10<sup>9</li>\n<li>1 \u2264 <b>w</b> \u2264 10<sup>4</sup></li>\n<li>Sum of <b>N</b> over all test cases cannot be greater than 10<sup>5</sup>.</li>\n<li>Sum of <b>Q</b> over all test cases cannot be greater than 10<sup>5</sup>.</li>\n<li>All numbers in the input are integers.</li>\n</ul>\n\n<h3>Example</h3>\n<pre>\n<b>Input:</b>\n<tt>1\n5 6\n1 0\n-1 2 -3 4 -5\n1 2\n1 3\n2 4\n2 5\n1 4 3 1\n2 4 3\n1 3 3 1\n2 3 3\n1 3 3 2\n2 4 3\n</tt>\n<b>Output:</b>\n<tt>3\n0\n4\n</tt>\n</pre>",
    "category_name": "main",
    "date_added": "9-12-2015",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6",
    "max_timelimit": "4",
    "problem_status": "unattempted",
    "editorial_url": "http://discuss.codechef.com/problems/CHEFTREE",
    "problem_tester": null,
    "time": {
        "view_start_date": 1450627200,
        "end_date": 1450636200,
        "practice_submission_allowed": true,
        "visible_start_date": 1450636200,
        "submit_start_date": 1450627200,
        "current": 1537435728
    },
    "user": {
        "username": ""
    }
}