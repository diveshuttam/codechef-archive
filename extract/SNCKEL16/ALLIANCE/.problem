{
    "problem_code": "ALLIANCE",
    "problem_author": "kingofnumbers",
    "contest_name": "SnackDown 2016 Online Elimination Round",
    "todo": false,
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;</span><span>kingofnumbers</span>",
    "problem_name": "Alliances",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": null,
    "contest_code": "SNCKEL16",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/binary-search'>binary-search</a>, <a class='problem-tag-small ' href='/tags/problems/kingofnumbers'>kingofnumbers</a>, <a class='problem-tag-small ' href='/tags/problems/lca'>lca</a>, <a class='problem-tag-small ' href='/tags/problems/snckel16'>snckel16</a>",
    "body": "<h3> Read problems statements in <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/SNCKEL16/mandarin/ALLIANCE.pdf\">Mandarin Chinese</a>, <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/SNCKEL16/russian/ALLIANCE.pdf\">Russian</a> and <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/SNCKEL16/vietnamese/ALLIANCE.pdf\">Vietnamese</a> as well.</h3>\n\n\n<p>\nTreeland is a country consisting of <b>N</b> cities numbered from 1 to <b>N</b>. The road network connecting these cities has tree structure, i.e. there is exactly one way of going from a city to another city via a path of roads.</p> \n\n<p>\nThere are <b>K</b> gangs living in the city, numbered from 1 to <b>K</b>. Gangs operate  over various cities, engaging in illicit trades. There might be more than one gangs operating in some cities. Sometimes they form alliances by grouping up with other gangs, thus making the city even more unsafe. They significantly increase their reach of the cities they control. Specially, the region controlled by the alliance will be the all the cities where some gang in the alliance operates, and also all the cities which lie in a path between some two cities controlled by the alliance.\n</p>\n\n<p>\nChef being a mayor of Treeland wants to choose one city as the capital, in which he will establish headquarter of police department. But first, he wants to make some investigations, by finding the answers of following queries. Can you please help him in this?\n</p>\n\n<p>\nIn each query, you will be given the city Chef wants to be the capital. Also, you will be given some set of gangs out of the above <b>K</b> gangs. For this query, assume that only the given set of gangs are operating in the city, others are inactive or perhaps caught up and put in the jail. Chef wants to catch some member of the alliance formed by the operating gangs, so that he can get the information about the members of entire alliance. For that, he wants to find out the nearest distance of some city controlled by the alliance from the capital city. It might be the case that the capital itself is controlled by the alliance, in that case nearest distance will be zero, obviously. \n</p>\n\n<p>\nPlease note that all the queries are independent of each other.\n</p>\n\n<h3>Input</h3>\n<p>The first line of the input contain an integer <b>N</b>, denoting the number of cities in Treeland.</p>\n<p>Each of the next <b>N-1</b> lines contains two space separated integers, <b>u</b>, <b>v</b>, denoting that city <b>u</b> and <b>v</b> are connected by a road.</p>\n<p>The next line contains an integer <b>K</b>, denoting the number of gangs operating in Treeland.</p>\n<p>Each of the next <b>K</b> lines provides a description of cities controlled by a gang. In particular, in the <b>i-th</b> line, you will be provided some space separated integers - first integer <b>c<sub>i</sub></b> will denote the number of cities controlled by the <b>i</b>-th gang, which will be followed by <b>c<sub>i</sub></b> integers denoting the list of cities controlled by the gang.</p>\n<p>Next line contains an integer <b>Q</b>, denoting the number of queries Chef wants you to answer.</p>\n<p>Next <b>Q</b> lines contain description of the queries, one query per line. The first integer will denote the capital city <b>V</b>, followed by an integer <b>t<sub>i</sub></b> denoting the number of gangs active for the purpose of this query, followed by  <b>t<sub>i</sub></b> integers denoting the list of the gangs.</p>\n\n<h3>Output</h3>\n<p>For each query, output a single integer corresponding to the answer of the query.</p>\n\n<h3>Constraints</h3>\n<ul>\n<li><b>1</b> \u2264 <b>N</b> \u2264 <b>500,000</b></li>\n<li><b>1</b> \u2264 <b>K</b> \u2264 <b>500,000</b></li>\n<li><b>1</b> \u2264 <b>Q</b> \u2264 <b>500,000</b></li>\n<li><b>1</b> \u2264 sum of <b>c<sub>i</sub></b> over all the <b>K</b> gangs \u2264 <b>500,000</b></li>\n<li><b>1</b> \u2264 sum of <b>t<sub>i</sub></b> over all the <b>Q</b> queries \u2264 <b>500,000</b></li>\n<li><b>1</b> \u2264 <b>c<sub>i</sub></b> \u2264 <b>N</b></li>\n<li><b>1</b> \u2264 <b>t<sub>i</sub></b> \u2264 <b>K</b></li>\n<li>For each gang <b>i</b> in the input, the list of cities controlled by the gang won't contain repeated elements</li>\n<li>For each query, the list of gangs active won't contain repeated elements.</li>\n</ul>\n\n<h3>Example</h3>\n<pre><b>Input:</b>\n<tt>7\n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n2\n2 6 7\n1 4\n3\n5 1 2\n1 1 1\n5 2 1 2</tt>\n<b>Output:</b>\n<tt>2\n1\n1</tt>\n</pre>\n\n<h3>Explanation</h3>\n<p><b>In query 1, </b> There is only one active gang for this query, i.e. gang 2. Gang 2 operates in city 4. Their alliance will control city 4 itself. Chef wants city 5 to be the capital city. Distance between city 4 and 5 is 2.</p>\n\n<p><b>In query 2, </b> There is only active gang for this query, i.e. gang 1. Gang 1 operates in cities 6, 7. The alliance will control the cities 6, 7 and 3. Chef wants city 1 to be the capital city. The minimum distance city controlled by alliance from the city 1 is 3, which is at a distance of 1.</p>\n\n<p><b>In query 3, </b> There are two active gang for this query, i.e. gang 1 and 2. Gang 1 operates in cities 6, 7 whereas gang 2 operates in city 4. \nTheir alliance will control the cities 1, 2, 3, 4, 6, 7 (i.e. all the cities except city 5). Chef wants to be city 5 capital. The minimum distance city controlled by the alliance from the city 5 is 2, which is at a distance of 1.</p>\n\n<h3>Note</h3>\nPlease note that default stack size is 8MB for C++ and 128MB for Java. ",
    "category_name": "main",
    "date_added": "7-06-2016",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS",
    "max_timelimit": "3.5",
    "problem_status": "unattempted",
    "editorial_url": "http://discuss.codechef.com/problems/ALLIANCE",
    "problem_tester": "kingofnumbers,antoniuk1,xcwgf666,kevinsogo",
    "time": {
        "view_start_date": 1466344800,
        "end_date": 1466362800,
        "practice_submission_allowed": true,
        "visible_start_date": 1777445150,
        "submit_start_date": 1466344800,
        "current": 1537434820
    },
    "user": {
        "username": ""
    }
}