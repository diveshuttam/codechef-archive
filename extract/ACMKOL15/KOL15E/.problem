{
    "problem_code": "KOL15E",
    "problem_author": "devuy11",
    "contest_name": "ACM-ICPC Asia-Kolkata Site First Round Online Contest 2015",
    "todo": false,
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;</span><span>devuy11</span>",
    "problem_name": "Weird Paths in a tree",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "",
    "contest_code": "ACMKOL15",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/acmkol15'>acmkol15</a>, <a class='problem-tag-small ' href='/tags/problems/devuy11'>devuy11</a>, <a class='problem-tag-small ' href='/tags/problems/dynamic-programming'>dynamic-programming</a>, <a class='problem-tag-small ' href='/tags/problems/medium-hard'>medium-hard</a>, <a class='problem-tag-small ' href='/tags/problems/rooted-trees'>rooted-trees</a>, <a class='problem-tag-small ' href='/tags/problems/treeroot'>treeroot</a>",
    "body": "<p>You are given a tree. Each node of the tree is assigned a distinct value.</p>\n<p>A path in the tree is considered weird if the values in the path increase and decrease alternatively.</p>\n<p>For example: Consider a straight chain of nodes 1\u21923\u21922\u21924\u21925 with value assigned to any node <b>i</b> being <b>i</b> itself. Then the path 3\u21922\u21924, 1\u21923\u21922, etc. are weird whereas 1\u21923\u21922\u21924\u21925 is not weird because 2\u21924 and 4\u21925 are both increasing.</p>\n<p>You are given <b>Q</b> queries. Each query contains the root of the tree, <b>R</b>, and an arbitrary node, <b>S</b>. For each query, you need to find the sum of all weird paths in the subtree rooted at <b>S</b> with respect to <b>R</b> being the root of the original tree. Sum of a path is defined as the sum of values assigned to all nodes on that path. As this sum could be very large, output it modulo <b>M</b>.</p>\n<b>Note:</b>\n<ul>\n<li>Paths of length 2 are always considered weird.</li>\n<li>A path is always defined for more than 1 node.</li>\n</ul>\n\n<h3>Input</h3>\n<p>The first line of input contains 2 integers, <b>N</b> and <b>M</b>.</p>\n<p>Second line contains <b>N</b> space separated numbers where the <b>i</b><sup>th</sup> number denotes the value of the <b>i</b><sup>th</sup> node. These <b>N</b> numbers are permutation of the sequence of numbers from <b>1</b> to <b>N</b>.</p>\n<p>For the next <b>N-1</b> line, each line contains 2 numbers <b>a</b> and <b>b</b>, denoting that node <b>a</b> is connected to node <b>b</b>.</p>\n<p>Next line contains a single integer <b>Q</b>, the number of queries to follow.</p>\n<p>Lastly, <b>Q</b> lines follow, where each line contains two space separated integers, <b>R</b> and <b>S</b>.</p>\n\n<h3>Output</h3>\n<p>For each query, output the sum modulo <b>M</b>.</p>\n\n<h3>Constraints</h3>\n<ul>\n<li><b>1</b> \u2264 <b>N</b> \u2264 <b>10<sup>5</sup></b></li>\n<li><b>1</b> \u2264 <b>M</b> \u2264 <b>10<sup>5</sup></b></li>\n<li><b>1</b> \u2264 <b>R</b> \u2264 <b>N</b></li>\n<li><b>1</b> \u2264 <b>S</b> \u2264 <b>N</b></li>\n<li><b>1</b> \u2264 <b>Q</b> \u2264 <b>10<sup>5</sup></b></li>\n</ul>\n\n<h3>Example</h3>\n<pre><b>Input:</b>\n6 100000\n1 2 3 4 5 6\n1 2\n2 5\n1 4\n3 4\n1 6\n5\n3 1\n5 2\n1 6\n2 4\n5 1\n\n<b>Output:</b>\n26\n81\n0\n7\n52\n\n</pre>\n\n<h3>Explanation</h3>\n<p><b>Query 1: </b>Nodes in the subtree 1 are [1,2,5,6]. Valid Paths are 5\u21922 , 2\u21921, 1\u21926, 2\u21921\u21926 . Corresponding sums are 7, 3, 7, and 9. Total sum is 26.</p>\n<b>Note:</b>\n<ul>\n<li>A Path lies in a subtree if all nodes on the path are in the subtree.</li>\n</ul>",
    "category_name": "main",
    "date_added": "14-10-2015",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA",
    "max_timelimit": "2",
    "problem_status": "unattempted",
    "editorial_url": "http://discuss.codechef.com/problems/KOL15E",
    "problem_tester": null,
    "time": {
        "view_start_date": 1446287400,
        "end_date": 1446296400,
        "practice_submission_allowed": true,
        "visible_start_date": 1757282690,
        "submit_start_date": 1446287400,
        "current": 1537435849
    },
    "user": {
        "username": ""
    }
}