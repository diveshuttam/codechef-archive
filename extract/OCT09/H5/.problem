{
    "status": "success",
    "problem_status": "unattempted",
    "problem_tester": null,
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><p>Johnny is developing some word processing software. Right now, he has to deal with the problem of formatting a paragraph.  Johnny has formulated the problem as follows.</p>\n<p>There are N words in a paragraph, in which the i<sup>th</sup> word has a<sub>i</sub> characters. Each line of the paragraph can hold at most M characters. For simplicity, we assume that every two consecutive words in a line are separated by <b>exactly one whitespace</b> and we disregard punctuation marks.</p>\n<p>The text editor always uses a simple greedy algorithm to break the paragraph into lines. The algorithm puts as many words in a line as possible, then moving on to the next line to do the same until there are no more words left to be placed.</p>\n<p>Johnny needs to write a program that, given the description of the words in a paragraph, is able to process the following two operations:</p>\n<ul>\n<li>Return the line number of a specified word</li>\n<li>Replace one word with another one</li>\n</ul>\n<p>Since the number of words in a paragraph can be huge, Johnny needs to find an efficient algorithm to process the above queries. Please help him!</p>\n\n<h3>Input</h3>\n<p>The first line contains t, the number of test cases (about 50). Then t test cases follow. Each test case has the following form:</p>\n<ul>\n<li>The first line contains a number M, the maximum number of characters that can be put in a line.</li>\n<li>The second line contains a number N, the number of words in the given paragraph.</li>\n<li>The third line contains N numbers a<sub>1</sub>, a<sub>2</sub>, ..., a<sub>N</sub>, the lengths of the words in the paragraph.</li>\n<li>The next lines contain the description of the queries, one query in a line. Each query can be of one of the following 3 types:\n</li>\n<ul>\n<li><i>I i</i> - Ask for the line number of the i<sup>th</sup> word.</li>\n<li><i>C i l</i> - Replace the i<sup>th</sup> word by a new word of length l (1 &#8804; l &#8804; M).</li>\n<li><i>E</i> - Signal the end of the description of the queries.</li>\n</ul>\n</ul>\n<p>Note that the line numbers and the word indexes are counted from 1.</p>\n<h3>Output</h3>\n<p>For each test case, the first line of output should contain the string \"Case #T:\" where T should be replaced by the corresponding test case number.</p>\n<p>For every 'I' query in the test case, print the correct line number of the word being queried.</p>\n<p>Print a blank line after each test case.</p>\n\n<h3>Constraints</h3>\n<ul>\n<li>1 &#8804; N &#8804; 50000</li>\n<li>1 &#8804; M &#8804; 100000</li>\n<li>1 &#8804; a<sub>i</sub> &#8804; M</li> \n<li>The number of lines in each paragraph never exceeds 200.</li>\n<li>The number of queries in each test case does not exceed 10000.</li>\n</ul>\n\n<h3>Example</h3>\n\n<pre>\n<b>Input:</b>\n2\n\n4\n2\n1 2\nI 2\nC 2 3\nI 2\nE\n\n6\n5\n1 5 4 5 6\nI 2\nI 4\nI 5\nC 4 1\nI 4\nI 5\nC 2 1\nC 3 2\nC 5 4\nI 5\nI 3\nE\n\n<b>Output:</b>\nCase #1:\n1\n2\n\nCase #2:\n2\n4\n5\n3\n4\n2\n1\n</pre>\n\n<h3>Discussion of the example</h3>\n<p>In the following description of the second exemplary test case, we use the digit i to denote a character of the i<sup>th</sup> word. Note that each line can hold at most 6 characters. Initially, the paragraph has the following form:</p>\n<pre>\n1\n22222\n3333\n44444\n555555\n</pre>\n<p>After replacing the 4<sup>th</sup>word with a one-character word, the paragraph becomes:</p>\n<pre>\n1\n22222\n3333 4\n555555\n</pre>\n<p>After the last 3 replacements, the paragraph becomes:</p>\n<pre>\n1 2 33\n4 5555\n</pre>",
    "category_name": "main",
    "user": {
        "username": ""
    },
    "date_added": "15-09-2009",
    "is_direct_submittable": false,
    "contest_name": "October 2009 (Contest IX)",
    "languages_supported": "C, JAVA, PYTH, CS2, PAS fpc, PAS gpc, RUBY, PHP, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, TEXT",
    "todo": false,
    "time": {
        "view_start_date": 1254389400,
        "end_date": 1255253400,
        "practice_submission_allowed": true,
        "visible_start_date": 1255253400,
        "submit_start_date": 1254389400,
        "current": 1537439899
    },
    "problem_author_html_handle": "admin",
    "problem_name": "Paragraph Formatting",
    "source_sizelimit": "50000",
    "tags": "<a class='problem-tag-small ' href='/tags/problems/admin'>admin</a>",
    "problem_tester_html_handle": "",
    "problem_author": "admin",
    "contest_code": "OCT09",
    "max_timelimit": "3.48",
    "problem_code": "H5"
}