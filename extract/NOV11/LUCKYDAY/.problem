{
    "problem_code": "LUCKYDAY",
    "problem_author": "laycurse",
    "contest_name": "November Long Contest 2011",
    "todo": false,
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;</span><span>laycurse</span>",
    "problem_name": "Lucky Days",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;</span><span>chmel_tolstiy</span>",
    "contest_code": "NOV11",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/hard'>hard</a>, <a class='problem-tag-small ' href='/tags/problems/laycurse'>laycurse</a>, <a class='problem-tag-small ' href='/tags/problems/nov11'>nov11</a>",
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><p>\nChef Ciel defined a sequence <strong>S</strong> as follows:<br />\n<strong>S</strong>[1] = <strong>A</strong><br />\n<strong>S</strong>[2] = <strong>B</strong><br />\n<strong>S</strong>[<strong>i</strong>] = (<strong>X</strong>*<strong>S</strong>[<strong>i</strong>-1] + <strong>Y</strong>*<strong>S</strong>[<strong>i</strong>-2] + <strong>Z</strong>) mod <strong>P</strong>, for <strong>i</strong> &gt;= 3<br />\n</p>\n\n<p>\nCiel considers <strong>C</strong> is a lucky number, and the <strong>i</strong>-th day is a lucky day if and only if <strong>S</strong>[<strong>i</strong>] = <strong>C</strong>.\nCiel's restaurant may have special events in a lucky day.\n</p>\n\n<p>\nBy the way, your work is calculating the numbers of lucky days in intervals.\nThat is, for each <strong>Q</strong> intervals [<strong>L</strong>[<strong>i</strong>], <strong>R</strong>[<strong>i</strong>]], \nyou should calculate the number of the integers <strong>k</strong> which satisfy <strong>L</strong>[<strong>i</strong>] &lt;= <strong>k</strong> &lt;= <strong>R</strong>[<strong>i</strong>] and <strong>S</strong>[<strong>k</strong>] = <strong>C</strong>.\n</p>\n\n<h3>Input</h3>\n<p>\nThe first line contains an integer <strong>T</strong>, the number of test cases.\nThen <strong>T</strong> test cases follow.\nThe first line for each test case has 8 integers <strong>A</strong>, <strong>B</strong>, <strong>X</strong>, <strong>Y</strong>, <strong>Z</strong>, <strong>P</strong>, <strong>C</strong> and <strong>Q</strong>.\nThe next <strong>Q</strong> lines have 2 integers <strong>L</strong>[<strong>i</strong>] and <strong>R</strong>[<strong>i</strong>].\n</p>\n\n<h3>Output</h3>\n<p>\nFor each interval, print the number of lucky days in the interval.\n</p>\n\n<h3>Constraints</h3>\n<p>\n1 &lt;= <strong>T</strong> &lt;= 2<br />\n2 &lt;= <strong>P</strong> &lt;= 10007<br />\n<strong>P</strong> is a prime.<br />\n0 &lt;= <strong>A</strong>, <strong>B</strong>, <strong>X</strong>, <strong>Y</strong>, <strong>Z</strong>, <strong>C</strong> &lt; <strong>P</strong><br />\n1 &lt;= <strong>Q</strong> &lt;= 20000 (2*10^4)<br />\n1 &lt;= <strong>L</strong>[<strong>i</strong>] &lt;= <strong>R</strong>[<strong>i</strong>] &lt;= 1000000000000000000 (10^18)<br />\n</p>\n\n<h3>Sample Input</h3>\n<pre>2\n1 1 1 1 0 2 0 6\n1 1\n2 2\n3 3\n4 4\n5 5\n6 6\n1 2 4 5 3 17 4 3\n5 8\n5 58\n58 5858</pre>\n\n<h3>Sample Output</h3>\n<pre>0\n0\n1\n0\n0\n1\n0\n4\n362</pre>\n\n<h3>Output details</h3>\n<p>\nIn the first case:<br />\n<strong>S</strong>[1] = <strong>A</strong> = 1<br />\n<strong>S</strong>[2] = <strong>B</strong> = 1<br />\n<strong>S</strong>[3] = (<strong>S</strong>[2] + <strong>S</strong>[1]) mod 2 = (1 + 1) mod 2 = 0<br />\n<strong>S</strong>[4] = (<strong>S</strong>[3] + <strong>S</strong>[2]) mod 2 = (0 + 1) mod 2 = 1<br />\n<strong>S</strong>[5] = (<strong>S</strong>[4] + <strong>S</strong>[3]) mod 2 = (1 + 0) mod 2 = 1<br />\n<strong>S</strong>[6] = (<strong>S</strong>[5] + <strong>S</strong>[4]) mod 2 = (1 + 1) mod 2 = 0<br />\n<strong>S</strong>[7] = (<strong>S</strong>[6] + <strong>S</strong>[5]) mod 2 = (0 + 1) mod 2 = 1<br />\n</p>",
    "category_name": "main",
    "date_added": "1-10-2011",
    "status": "success",
    "languages_supported": "C, JAVA, PYTH, PYTH 3.6, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, CLOJ, FS",
    "max_timelimit": "0.529322",
    "problem_status": "unattempted",
    "editorial_url": "http://discuss.codechef.com/problems/LUCKYDAY",
    "problem_tester": "chmel_tolstiy",
    "time": {
        "view_start_date": 1320139800,
        "end_date": 1321003800,
        "practice_submission_allowed": true,
        "visible_start_date": 1321003800,
        "submit_start_date": 1320139800,
        "current": 1537439095
    },
    "user": {
        "username": ""
    }
}