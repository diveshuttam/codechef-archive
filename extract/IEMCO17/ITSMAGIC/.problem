{
    "status": "success",
    "problem_status": "unattempted",
    "problem_tester": null,
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><h3>Problem description</h3>\n<p>Mojo loves to play with non-negative numbers. One day, he discovered a number in which every digit is either 1 greater than its just left neighbour or 1 less than its just left neighbour, and also every digit is either 1 greater than its just right neighbour or 1 less than its just right neighbour.\nIf only one of the neighbour digits exists, then either just left side or just right side neighbour should be 1 greater or 1 less. Mojo calls such group of numbers as \u201cMagical Numbers\u201d. All single digit numbers also falls into this category.\n<br>\n<b>For example : 0, 2 , 6 , 12, 121, 989, 3212 etc.</b> <br>\nOne day his naughty friend Dodo visited his house. He saw the collection of all Magical numbers in his house. Being curios in nature, he started thinking about those numbers (since he didn\u2019t know about Magical Numbers).After thinking a lot, he took a number <b>\u201cN\u201d</b> just greater than or equal to the maximum number in that collection of Magical Numbers and hence added all those <b>non negative numbers</b> till <b>\u201cN\u201d</b> which were not present in that collection. And then arranged all the numbers in increasing order. Here <b>\u201cN\u201d</b> can be any number greater than or equal to maximum Magical Number of Mojo\u2019s collection.<br>\nAfter seeing that his collection of Magical numbers had disturbed, Mojo became angry on Dodo and asked him to replace  Non-Magical numbers with the Magical numbers initially he had. <br>\nHence, Mojo gave <b>\u201cQ\u201d</b> queries to Dodo of following type: <br>\n<br><b>1. Find the count of all Magical numbers within a given range <b>[L,R]</b>.Also find the sum of all Magical as well as Non-Magical numbers in same range. </b><br><br>\n<b>2.Update the disturbed collection at index <b>\u201ci\u201d</b> if number at index <b>\u201ci\u201d</b> is Non-Magical. If number is Non-Magical prime, then it must be replaced with Magical prime just greater than that Non-Magical prime and less than or equal to \"N\". If no such number exists, replace the Non-Magical prime with greatest Magical Prime less than or equal to <b>\u201cN\u201d</b>.<br>\nSimilarly, if the number is Non-magical Non prime, then it must be replaced with Magical Non prime just greater than that Non-Magical Non prime and less than or equal to \"N\". If no such number exists, replace the Non-Magical Non prime with greatest Magical Non Prime less than or equal to <b>\u201cN\u201d</b>.</b><br><br>\n\nAfter all the queries, Mojo will become <b>happy</b> with dodo, if Magical Numbers in entire collection is greater than Non-Magical numbers.\n\n<br><br><b>Note: Queries on Disturbed collection are 1-indexed.</b>\n.</p>\n\n\n<h3>Input</h3>\n<p>First line contains an integer <b>\u201cT\u201d</b> denoting  number of test cases.<br>First line of each test case contains two space separated integers <b>\u201cN\u201d</b> and <b>\u201cQ\u201d</b>, denoting the number selected by Dodo and the number of  queries.\nNext <b>Q</b> lines consists of queries of following form :\n<ul>\n<li><b>1 L R</b>: (1 is type and  <b>L</b> and <b>R</b> as described above)</li>\n<li><b>2 i</b>: (2 is type and <b>\u201ci\u201d</b> is index to be updated as described above.)</li>\n</ul></p>\n<h3>Output</h3>\n<p>In each test case, for query of type 1, output two space separated integers as described above, in a new line.\nAfter all the queries, output  \u201chappy\u201d(without quotes) if Mojo is happy else output \u201cunhappy\u201d(without quotes) in a new line.\n</p>\n\n<h3>Constraints</h3>\n<ul>\n<li><b>1</b> \u2264 <b>N</b> \u2264 <b>10^6</b></li>\n<li><b>1</b> \u2264 <b>Q</b> \u2264 <b>10^5</b></li>\n<li><b>type={1,2}</b></li>\n<li><b>1</b> \u2264 <b>L</b> \u2264 <b>R</b> \u2264 <b>N+1</b></li>\n<li><b>1</b> \u2264 <b>T</b> \u2264 <b>10</b></li></ul>\n<br>\n<h3>Example</h3>\n<pre><b>Input:</b>\n\n2\n21 5\n1 4 10\n2 10\n1 5 13\n2 12\n1 9 22\n25 4\n2 13\n2 18\n2 25\n1 1 25\n\n\n<b>Output:</b>\n\n7 42\n8 72\n6 199\nhappy\n16 303\nhappy\n\n</pre>\n<br>\n<h3>Explanation</h3>\n<p>\n<b>Case 1:</b>\n<br>Dodo took a number <b>\"21\"</b>.Hence in Mojo's collection the maximum Magical number must be just less than or equal to <b>21</b>.So, it must be <b>21</b> itself.<br>\nNow the disturbed collection contains : <b>0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21.</b><br>\nThus Mojo's collection of Magical Numbers must had been as follows:<br><b>0,1,2,3,4,5,6,7,8,9,10,12,21</b><br> whereas all other numbers are Non-Magical.<br><br>\n\n<b>Query 1</b>: Count=7(3,4,5,6,7,8,9) Sum=42 (3+4+5+6+7+8+9)\n<br><b>Query 2</b>: Index <b>10</b> has value 9 which is already a \"Magical Number\", so no update needed.\n<br><b>Query 3</b>: Count=8(4,5,6,7,8,9,10,12) Sum=(4+5+6+7+8+9+10+11+12)\n<br><b>Query 4</b>: Index <b>12</b> has value 11 which is non-Magical Prime.Since there are no Magical Prime just greater than 11 and less than <b>21</b>.Hence index <b>12</b> is updated with maximum Magical Prime less than or equal to 21 ie <b>7</b>.\n<br><b>Query 5</b>: Count=6(8,9,10,7,12,21) Sum=199(8+9+10+7+12+13+14+15+16+17+18+19+20+21)<br>\n<br> Now out of  22 numbers in Collection, 14 numbers are Magical.Hence Mojo become <b>happy</b>.\n</p>",
    "category_name": "main",
    "user": {
        "username": ""
    },
    "date_added": "19-04-2017",
    "is_direct_submittable": false,
    "contest_name": "IEM Coding Olympiad (IEMCO) 2017",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS",
    "todo": false,
    "time": {
        "view_start_date": 1493562600,
        "end_date": 1493573400,
        "practice_submission_allowed": true,
        "visible_start_date": 1493573400,
        "submit_start_date": 1493562600,
        "current": 1537433909
    },
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;</span><span>dwij28</span>",
    "problem_name": "Magical Number",
    "source_sizelimit": "50000",
    "tags": "<a class='problem-tag-small ' href='/tags/problems/dwij28'>dwij28</a>",
    "problem_tester_html_handle": "",
    "problem_author": "dwij28",
    "contest_code": "IEMCO17",
    "max_timelimit": "2",
    "problem_code": "ITSMAGIC"
}