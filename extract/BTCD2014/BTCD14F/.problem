{
    "status": "success",
    "problem_status": "unattempted",
    "problem_tester": null,
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><p>Sherlock and Watson, tired of solving mysteries all day, take the subways of London to get back to Baker Street. Just to ruin their free time, Moriarty has rigged the entire subway with highly powerful bombs. The bombs are planted both on the tracks as well as the stations. It is up to Sherlock and Watson to save the city, again.</p>\n<p>Sherlock knows the complete map of London\u2019s subway system \u2013 which can be simply drawn as a 2D grid where each cell represents a region in London. Using \u201chis eyes and ears all over the city\u201d \u2013 the Homeless Network, Sherlock has found the places where the bombs are planted and the type of bombs planted. In order to maximize the efficiency of defusing the bombs, Sherlock and Watson plan on starting at 2 different corners of the map. Watson suggested that they should start at the diagonally opposite corners of the map. However Sherlock felt that it is too mainstream and wants to start at two adjacent corners of the map \u2013 Sherlock from the top-left corner and Watson from the bottom-left corner.</p>\n<p>Once they\u2019ve started, Sherlock can move to the cell to the right of his current cell or to the cell below. Similarly, Watson can move to the cell to his right or the cell above. Ultimately, through a sequence of bomb defusal, they will end up in a cell that is diagonally opposite to their start cell, i.e. Sherlock should reach the bottom-right corner and Watson should reach the top-right corner. Clearly, Sherlock and Watson have to cross each other\u2019s paths before reaching their destination cells. The bombs can be defused only once in such cases.</p>\n<p>Every cell in the map can be in one of the following 3 states \u2013</p>\n<p><span style=\"white-space: pre;\"> </span>i. \u00a0 \u00a0The region is blocked. It is denoted by <strong>-1</strong> on the map.</p>\n<p><span style=\"white-space: pre;\"> </span>ii. \u00a0 The region is a track rigged with a bomb.</p>\n<p><span style=\"white-space: pre;\"> </span>iii. \u00a0The region is a station rigged with a bomb.</p>\n<p>Obviously, Sherlock and Watson cannot traverse through the blocked regions. Since they are experts in defusing a bomb, they can do it zero units of time. Every non-blocked region has an associated cost \u2013 the cost to defuse the bomb in that cell. For any cell they visit, they will always defuse the bomb in that cell. Their main objective is to minimize the total cost of defusing the bombs. However, being the good guys, they do not want the people at the stations to lose their lives, so they have to defuse the bombs at all the stations.</p>\n<p>Can you help him calculate the minimum cost that they have to spend, without leaving any station to explode?</p>\n<p><strong>Input Description:</strong></p>\n<p>The first line of the input has a single integer <strong>T</strong>, denoting the number of test cases. Each test case begins with 2 integers <strong>N</strong> and <strong>M</strong> denoting the number of rows and columns in the map. N lines follow, each having M values that can be an integer, denoting the cost of defusing the bomb in that region or -1 if the region is blocked.</p>\n<p>In the next line an integer <strong>K</strong> is given, denoting the number of stations in London\u2019s subway. The next K lines have 2 integers <strong>X</strong> and <strong>Y</strong>, meaning that the cell at row X (1 indexed) and column Y (1 indexed) in the grid is a station</p>\n<p><strong>Output Description:</strong></p>\n<p>For each test case, print a single integer denoting the minimum cost that has to be spent, without leaving any station to explode. If there isn\u2019t any route in which the bombs are defused at all the stations or if Sherlock and Watson can\u2019t reach their corresponding destinations, print -1.</p>\n<p><strong>Constraints:</strong></p>\n<p>1 &lt;= <strong>T</strong> &lt;= 10</p>\n<p>3 &lt;= <strong>N,M</strong> &lt;= 1000</p>\n<p>-1 &lt;= <strong>grid[i][j]</strong> &lt;= 1000</p>\n<p>1 &lt;= <strong>K</strong> &lt;= 100</p>\n<p>1 &lt;= <strong>X</strong> &lt;= <strong>N</strong></p>\n<p>1 &lt;= <strong>Y</strong> &lt;= <strong>M</strong></p>\n<p><strong>Sample Test Case:</strong></p>\n<p><strong>Input:</strong></p>\n<p>1</p>\n<p>3 3</p>\n<p>1 2 3</p>\n<p>4 -1 6</p>\n<p>7 8 9</p>\n<p>1</p>\n<p>1 2</p>\n<p><strong>Output:</strong></p>\n<p>32</p>\n",
    "category_name": "main",
    "user": {
        "username": ""
    },
    "date_added": "7-03-2014",
    "is_direct_submittable": false,
    "contest_name": "ByteCode 2014",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, CLOJ, FS",
    "todo": false,
    "time": {
        "view_start_date": 1394290800,
        "end_date": 1394308800,
        "practice_submission_allowed": true,
        "visible_start_date": 1394308800,
        "submit_start_date": 1394290800,
        "current": 1537437712
    },
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;</span><span>vshriram93</span>",
    "problem_name": "Defuse the bombs!",
    "source_sizelimit": "50000",
    "tags": "<a class='problem-tag-small ' href='/tags/problems/vshriram93'>vshriram93</a>",
    "problem_tester_html_handle": "",
    "problem_author": "vshriram93",
    "contest_code": "BTCD2014",
    "max_timelimit": "1 - 4",
    "problem_code": "BTCD14F"
}