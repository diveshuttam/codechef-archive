{
    "problem_code": "PFRUIT",
    "problem_author": "ohweonfire",
    "contest_name": "July Challenge 2018 Division 1",
    "todo": false,
    "problem_author_html_handle": "ohweonfire",
    "problem_name": "Picking Fruit for Chefs",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "",
    "contest_code": "JULY18A",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/hard'>hard</a>, <a class='problem-tag-small ' href='/tags/problems/july18'>july18</a>, <a class='problem-tag-small ' href='/tags/problems/ohweonfire'>ohweonfire</a>",
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><h3>Read problems statements in <a target=\"_blank\" \nhref=\"http://www.codechef.com/download/translated/JULY18/mandarin/PFRUIT.pdf\">Mandarin chinese</a>, <a target=\"_blank\" \nhref=\"http://www.codechef.com/download/translated/JULY18/russian/PFRUIT.pdf\">Russian</a> and <a target=\"_blank\" \nhref=\"http://www.codechef.com/download/translated/JULY18/vietnamese/PFRUIT.pdf\">Vietnamese</a> as well.</h3>\n\nThe chefs are making fruit salads today! There are $k$ chefs in total, each making a different type of salad. However, the chefs have run out of fruit, so they sent $m$ workers to pick fruit for them.\n\nSome workers are fast, but some are really slow. Specifically, for each worker, we know two integers $a$ and $b$, which mean that this worker can pick between $a$ and $b$ units of fruit today (inclusive). There are $n$ groups of workers; all workers in each group have the same $a, b$.\n\nThe workers don't care about the number of units of fruit they pick, so they choose these numbers randomly. A worker with parameters $a$, $b$ will choose an integer between $a$ and $b$ uniformly randomly and pick this number of units of fruit today.\n\nIf the number of units of fruit picked by all workers together at the end of the day is $S$, the chefs define the *goodness* of the day as $F(S)=S^k$ for some reason. They would like you to find the expected value of $F$. It can be proven that this expected value can be written as a fraction $P/Q$, where $P \\ge 0$ and $Q \\gt 0$ are coprime integers. You should calculate $P\\cdot Q^{-1}$ modulo $998244353$, where $Q^{-1}$ denotes the modular inverse of $Q$ modulo $998244353$. (It is guaranteed that this inverse exists and is unique.)\n\n### Input\n- The first line of the input contains two space-separated integers $k$ and $m$.\n- The second line contains a single integer $n$.\n- Each of the following $n$ lines contains three space-separated integers $A$, $B$ and $C$ denoting a group of workers; there are $C$ workers in this group, with $a=A$ and $b=B$ for each of them.\n\n### Output\nPrint a single line containing one integer - the value of $P\\cdot Q^{-1}$ modulo $998244353$.\n\n### Constraints\n- $1 \\le n\\cdot k \\le 10^5$\n- $1 \\le A \\le B \\le 10^9$\n- $1 \\le C \\lt 998244353$\n- the sum of all $C$ is equal to $m$\n\n### Subtasks\n**Subtask #1 (20 points):** $n, k \\le 50$\n\n**Subtask #2 (30 points):** $n, k \\le 200$\n\n**Subtask #3 (50 points):** original constraints\n\n### Example Input\n```\n2 2\n2\n1 1 1\n1 2 1\n```\n\n### Example Output\n```\n499122183\n```\n\n### Explanation\nThere are two workers. The first worker always picks $1$ unit of fruit. The second worker can pick $1$ or $2$ units. If he picks $1$ unit, $S=2$ and $F=4$. If he picks $2$ units, $S=3$ and $F=9$. Each situation happens with probability $1/2$, so the expected value is $4/2+9/2=13/2$. This means $P=13$ and $Q=2$, so $Q^{-1}=499122177$.\n",
    "category_name": "main",
    "date_added": "20-06-2018",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, CLOJ, COB, FS",
    "max_timelimit": "2",
    "problem_status": "unattempted",
    "editorial_url": "https://discuss.codechef.com/problems/PFRUIT",
    "problem_tester": null,
    "time": {
        "view_start_date": 1530869400,
        "end_date": 1531733400,
        "practice_submission_allowed": true,
        "visible_start_date": 1531733400,
        "submit_start_date": 1530869400,
        "current": 1537432286
    },
    "user": {
        "username": ""
    }
}