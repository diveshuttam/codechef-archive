{
    "status": "success",
    "problem_status": "unattempted",
    "problem_tester": null,
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><p>Suppose we have recurrences of the following form, characterized by three parameters <b>m</b>, <b>sigma<sub>1..m</sub></b> and <b>f<sub>0..m-1<sub></sub></sub></b>, where <b>m</b> > 0 and <b>sigma<sub>i</sub></b> is a binary variable (1 &lt;= <b>i</b> &lt;= <b>m</b>).\n</p>\n<p>A sequence of number <b>s</b> can be generated as followings:</p>\n<ul>\n<li>if <b>i</b> &lt; <b>m</b>, then <b>s<sub>i</sub></b> = <b>f<sub>i</sub></b></li>\n<li>otherwise, i.e. <b>i</b> >= <b>m</b>, <b>s<sub>i</sub></b> = <b>f<sub>i - 1</sub></b> * <b>sigma<sub>1</sub></b> + ... + <b>f<sub>i - j</sub></b> * <b>sigma<sub>j</sub></b> + ... + <b>f<sub>i - m</sub></b> * <b>sigma<sub>m</sub></b></li>\n</ul>\n<p>Given <b>m, n, sigma<sub>1..m</sub></b> and <b>f<sub>0..m-1<sub></sub></sub></b>, compute <b>s<sub>n</sub></b> modulo 10^9 + 7.</p>\n<h3>Input</h3>\n<p>\nFirst line of input contains a positive interger <b>T</b>, then <b>T</b> testcases follow.\n</p>\n<p>For each testcase, first line contains positive integer <b>m</b> and non-negative integer <b>n</b><br />\nseparated by a single space. Second line contains <b>m</b> integers of <b>f<sub>0..m-1</sub></b>, separated by single space. Third line contains <b>m</b> numbers of <b>sigma<sub>1..m</sub></b>, separated by single space. </p>\n<h3>Output</h3>\n<p>For each testcase, output should contain a single number <b>s<sub>n</sub></b> modulo 10^9 +7 followed by a newline.</p>\n<h3>Constraints</h3>\n<p>1 &lt;= <b>T</b> &lt;= 20</p>\n<p>1 &lt;= <b>m</b> &lt;= 100</p>\n<p>0 &lt;= <b>n</b> &lt;= 10^9</p>\n<p>-10^9 &lt;= <b>f<sub>i</sub></b> &lt;= 10^9</p>\n<p><b>sigma<sub>i</sub></b> = 0 or 1</p>\n<h3>Example</h3>\n<pre><b>Input:</b>\n2\n2 100\n1 1\n1 1\n3 10\n1 1 1\n1 1 1\n\n<b>Output:</b>\n782204094\n193\n</pre>\n<p><b>\n<p>Problem Setter : Asif Haque</p>\n<p></p></b></p>\n",
    "category_name": "main",
    "user": {
        "username": ""
    },
    "date_added": "3-12-2013",
    "is_direct_submittable": false,
    "contest_name": "ACM-ICPC Practice round 2014",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, CLOJ, FS",
    "todo": false,
    "time": {
        "view_start_date": 1417372200,
        "end_date": 1418837400,
        "practice_submission_allowed": true,
        "visible_start_date": 1418837400,
        "submit_start_date": 1417372200,
        "current": 1537437125
    },
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;</span><span>shangjingbo</span>",
    "problem_name": "Family of Recurrences",
    "source_sizelimit": "50000",
    "tags": "<a class='problem-tag-small ' href='/tags/problems/kan13acm'>kan13acm</a>, <a class='problem-tag-small ' href='/tags/problems/matrix-expo'>matrix-expo</a>, <a class='problem-tag-small ' href='/tags/problems/medium'>medium</a>, <a class='problem-tag-small ' href='/tags/problems/shangjingbo'>shangjingbo</a>",
    "problem_tester_html_handle": "",
    "problem_author": "shangjingbo",
    "contest_code": "ICPC14PR",
    "max_timelimit": "1.80905",
    "problem_code": "KAN13D"
}