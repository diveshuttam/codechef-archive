{
    "status": "success",
    "problem_status": "unattempted",
    "problem_tester": null,
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><p>Treeland is a country with <b>N</b> cities connected to each other with <b>N-1</b> bidirectional roads in such a way that there is some path between every 2 cities.</p>\n<p>Because of the smooth roads, the preferred method of travel in Treeland is via taxi. When someone takes a taxi between 2 cities the driver always uses the shortest path between these 2 cities. However, the fare calculation for journeys done via taxi is slightly odd.</p>\n<p>For each city <b>i</b> there is an associated value <b>Fare<sub>i</sub></b>. When someone travels from some city <b>u</b> to some city <b>v</b> the taxi driver notes down the fare value of every city you pass through. Finally when they reach their destination, the driver first multiplies together all the fare values which are equal and then adds up these new values to get the final fare (see sample cases for clarification). Since the final fare can be very large the taxi driver simply gives the fare modulo <b>1000000007(10<sup>9</sup>+7)</b></p>\n<p>Now, being an avid traveler, Lukas wants to know how much it would cost him to travel between some cities. More specifically, he has <b>Q</b> questions where he asks you what would be the total fare if travels between some city <b>u</b> and some city <b>v</b>. Can you answer all of his questions?</p>\n<h3>Input</h3>\n<p>The first line of input will contain a single integer <b> N</b> denoting the number of cities.<br />\n<br /><br />\nThe second line contains <b>N</b> space-separated integers <b>Fare<sub>1</sub></b>,<b>Fare<sub>2</sub></b>, ..., <b>Fare<sub>N</sub></b> denoting the fare value of each city.<br />\n<br /><br />\nThe next <b>N-1</b> lines contain 2 space-separated integers <b>u</b> and <b>v</b> each, signifying there is a road between city <b>u</b> and <b>v</b>.<br />\n<br /><br />\nThe next line contains a single integer <b>Q</b> denoting the number of queries.<br />\n<br /><br />\nThe next <b>Q</b> lines contain 1 query per line. Each line will have 2 space-separated integers <b>u</b> and <b>v</b> each denoting a question Lukas asks you.\n</p>\n<h3>Output</h3>\n<p>For each of the <b>Q</b> queries output a single line with the result of the query. Print the result for each query in the order they are given in the input.</p>\n<h3>Constraints</h3>\n<p><ul>\n<li><b>1</b> \u2264 <b>N,Fare<sub>i</sub>,Q</b> \u2264 <b>100000</b></li>\n<li><b>1</b> \u2264 <b>u,v</b> \u2264 <b>N</b></li>\n</ul>\n</p>\n<h3>Example</h3>\n<pre><b>Input:</b>\n5\n2 3 2 3 2\n1 2\n1 3\n3 4\n4 5\n4\n2 3\n1 4\n2 5\n2 2\n\n<b>Output:</b>\n7\n7\n17\n3\n\n</pre><h3>Explanation</h3>\n<p><b>Query 1.</b><br />\nThe path between city 2 and 3 is 2->1->3. The fare values of the cities are 3,2,2. Therefore the total fare will be equal to 3 + (2*2) = 7.\n</p>\n<p><b>Query 2.</b><br />\nThe path between city 1 and 4 is 1->3->4. The fare values of the cities are 2,2,3. Therefore the total fare will be equal to (2*2) + 3 = 7.\n</p>\n<p><b>Query 3.</b><br />\nThe path between city 2 and 5 is 2->1->3->4->5. The fare values of the cities are 3,2,2,3,2. Therefore the total fare will be equal to (3*3) + (2*2*2) = 17.\n</p>\n<p><b>Query 4.</b><br />\nThe path between city 2 and 2 is just the city 2 itself. The fare value of city 2 is 3. Therefore the total fare will be equal to 3. It is rather strange why taxi drivers would charge you money to do nothing, but like the problem statement says \"the fare calculation for journeys done via taxi is slightly odd\".\n</p>\n",
    "category_name": "main",
    "user": {
        "username": ""
    },
    "date_added": "27-01-2016",
    "is_direct_submittable": false,
    "contest_name": "ICPC Preparatory Series by Team Sataday",
    "languages_supported": "C, CPP14, JAVA",
    "todo": false,
    "time": {
        "view_start_date": 1454256600,
        "end_date": 1454274600,
        "practice_submission_allowed": true,
        "visible_start_date": 1454274600,
        "submit_start_date": 1454256600,
        "current": 1537435563
    },
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;</span><span>akulsareen</span>",
    "problem_name": "Taxi Fare",
    "source_sizelimit": "50000",
    "tags": "<a class='problem-tag-small ' href='/tags/problems/akulsareen'>akulsareen</a>",
    "problem_tester_html_handle": "",
    "problem_author": "akulsareen",
    "contest_code": "IPC15P2A",
    "max_timelimit": "5",
    "problem_code": "SATA09"
}