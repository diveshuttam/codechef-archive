{
    "status": "success",
    "problem_status": "unattempted",
    "problem_tester": null,
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><p>Roger was able to solve his problem based on tree last time, only because of your help. He has been doing good and is learning and practicing various problems on trees (as he likes solving problems on connected undirected acyclic graphs). This time he is stuck with a harder problem and has spent almost a week trying to solve this problem, with no efficient solution till now. But, he has you as his friend and he knows that only you can help him with your excellent programming skills.</p>\n<p>You will be given an input in the form of a growing tree. That is, initially you have a tree consisting only of vertex <b>1</b>. At each step the tree will grow. So next, vertex <b>u</b> will be connected to vertex <b>1</b>, then vertex <b>v</b> will be connected to either vertex <b>1</b> or vertex <b>u</b>, and so on till you get a tree consisting of '<b>N</b>' vertex. However, at any instant while adding the vertexes you will be given a vertex '<b>x</b>' (which is already present in the tree grown so far), and you will be asked to print the eccentricity of the given vertex <b>x</b>.</p>\n<p>\n</p><p>Let <b>G</b> be a graph and '<b>x</b>' be a vertex of <b>G</b>.</p>\n<p>The eccentricity of the vertex '<b>x</b>' is the maximum distance from '<b>x</b>' to any vertex present in <b>G</b>.</p>\n<p>That is, <b>e (x) = max {d (x, y) : y is in G}</b>.</p>\n<p>Of Course vertex <b>y</b>, should also be present in the tree, grown so far.</p>\n<p>Along with the eccentricity, you should also print the vertex '<b>y</b>'.</p>\n<p>Please help Roger.</p>\n<p>\n<h3><b>Input</b></h3>\n</p>\n<p>First line contains '<b>N</b>' and '<b>M</b>', where <b>N</b> = Number of nodes in the tree and <b>M</b> = Number of Queries.</p>\n<p>Next <b>M</b> lines will either have an input of the type \"<b>U x y</b>\" or \"<b>Q x</b>\".</p>\n<p>For the input of type \"<b>U x y</b>\",  you have to connect the vertex '<b>y</b>' to the vertex '<b>x</b>', where vertex '<b>x</b>' is already present in the tree and vertex '<b>y</b>' is the new vertex. Obviously there will be <b>(N - 1)</b> inputs of the type \"<b>U x y</b>\".</p>\n<p>\n<h3><b>Output</b></h3>\n</p>\n<p>For each input of the type \"<b>Q x</b>\", you have to print the eccentricity of vertex '<b>x</b>', followed by the vertex '<b>y</b>'.</p>\n<p>If there are multiple such '<b>y</b>'. Print the smallest '<b>y</b>'.</p>\n<p>\n<h3><b>Constraints</b></h3>\n</p>\n<p><b>1  \u2264  N  \u2264  10^5</b></p>\n<p><b>N - 1  \u2264  M  \u2264  2*N</b></p>\n<p><b>1  \u2264  x, y  \u2264  N</b></p>\n<p>\n<h3><b>Example</b></h3>\n</p>\n<p>\n</p><p><b>Input</b></p>\n<p>5 8</p>\n<p>Q 1</p>\n<p>U 1 4</p>\n<p>Q 1</p>\n<p>U 4 2</p>\n<p>U 1 5</p>\n<p>U 5 3</p>\n<p>Q 1</p>\n<p>Q 2</p>\n<p>\n</p><p><b>Output</b></p>\n<p>0 1</p>\n<p>1 4</p>\n<p>2 2</p>\n<p>4 3</p>\n<p>\n<h3><b>Explanation</b></h3>\n</p>\n<p>Initially the tree has vertex 1.</p>\n<p>Q 1   => Eccentricity of vertex 1 is 0.</p>\n<p>U 1 4 => Connect vertex 4 to vertex 1.</p>\n<p>Q 1   => Eccentricity of vertex 1 is 1.</p>\n<p>U 4 2 => Connect vertex 2 to vertex 4.</p>\n<p>U 1 5 => Connect vertex 5 to vertex 1.</p>\n<p>U 5 3 => Connect vertex 3 to vertex 5.</p>\n<p>Q 1   => Eccentricity of vertex 1 is 2. Vertex 2 and Vertex 3 both are at a distance of 2 from vertex 1. Print the smaller one.</p>\n<p>Q 2   => Eccentricity of vertex 2 is 4.</p>\n",
    "category_name": "main",
    "user": {
        "username": ""
    },
    "date_added": "27-02-2015",
    "is_direct_submittable": false,
    "contest_name": "CodeCracker 2015",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS",
    "todo": false,
    "time": {
        "view_start_date": 1425130200,
        "end_date": 1425148200,
        "practice_submission_allowed": true,
        "visible_start_date": 1425148200,
        "submit_start_date": 1425130200,
        "current": 1537436689
    },
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #1E7D22;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>2&#9733;</span><span>harshitasia</span>",
    "problem_name": "Roger and Tree III",
    "source_sizelimit": "50000",
    "tags": "<a class='problem-tag-small ' href='/tags/problems/harshitasia'>harshitasia</a>",
    "problem_tester_html_handle": "",
    "problem_author": "harshitasia",
    "contest_code": "COCR2015",
    "max_timelimit": "2",
    "problem_code": "COCR10"
}