{
    "problem_code": "AMR16G",
    "problem_author": "admin3",
    "contest_name": "ACM-ICPC Asia-Amritapuri Onsite Mirror Contest 2016",
    "todo": false,
    "problem_author_html_handle": "admin3",
    "problem_name": "Hawala Arrests",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "",
    "contest_code": "AMR16MOS",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/admin3'>admin3</a>",
    "body": "<p>\nAt Intensely Corrupt Private Company (ICPC), everyone is, well, intensely corrupt. There are a total of <b>N</b> employees, numbered from <b>1</b> to <b>N</b>. The company is structured hierarchically, like a tree. ie. there is a CEO, who happens to be numbered <b>1</b>. Every other employee has exactly 1 manager directly above him, and following the chain of managers up from any employee will take you to the CEO, who has no manager above him. To avoid paying taxes, the employees use Hawala traders to transfer money to secret foreign accounts. There are a total of <b>K</b> Hawala traders. Each employee uses some of these <b>K</b> different Hawala traders (possibly none, or possibly all of the <b>K</b>). The Hawala traders are very careful. They start out with one client in the company. And then, they take up a new client from the company only if the new client happens to be the manager of one of their existing clients, or the new client's manager is one of their existing clients. So this means that for each of the <b>K</b> Hawala traders, their client-list in the company is very close-knit.<p>\n\n<p>\nYou are working for the investigation team investigating the Hawala traders. Luckily, you have discovered an unhappy employee of this company, who wants to bring down this entire operation. This employee has given you, for each Hawala trader, the employees of the company who use that Hawala trader. Your agency wants to bring all the <b>K</b> Hawala traders down. To bring down a Hawala trader, at least 1 of the employees who is a client of that trader has to be arrested. Find the minimum number of arrests that you must make to bring down all the <b>K</b> Hawala traders.\n</p>\n\n<h3>Input</h3>\n<p>The first line of input contains an integer <b>T</b> denoting the number of test cases. The description of <b>T</b> test cases follows.</p>\n<p>The first line of each test case contains two integers <b>N, K</b>, denoting the number of employees, and the number of Hawala traders, respectively.</p>\n<p>The next line contains <b>N-1</b> integers ,separated by single spaces: <b>M<sub>2</sub>, M<sub>3</sub>, .., M<sub>N</sub></b>, denoting that Employee <b>i's</b> manager is <b>M<sub>i</sub></b>. Note that Employee <b>1</b> is the CEO, and hence <b>M<sub>1</sub></b> does not exist.</p>\n<p><b>K</b> lines follow, where the <b>i<sup>th</sup></b> line describes the client list of the <b>i<sup>th</sup></b> Hawala trader. Each of these lines starts out with an integer <b>S<sub>i</sub></b>, which is the size of the client list, and then <b>S<sub>i</sub></b> space separated integers follow, in the same line: <b>C<sub>i1</sub>, C<sub>i2</sub>, .., C<sub>iS<sub>i</sub></sub></b>, denoting that employee <b>C<sub>ij</sub></b> is a client of the <b>i<sup>th</sup></b> Hawala trader.</p>\n\n<h3>Output</h3>\n<p>For each test case, output a single line containing the answer, which is the minimum number arrests that should be made.</p>\n\n<h3>Constraints</h3>\n<ul>\n<li><b>1 \u2264 T \u2264 3</b></li>\n<li><b>1 \u2264 N, K \u2264 10<sup>6</sup></b></li>\n<li><b>1 \u2264 M<sub>i</sub> \u2264 N</b></li>\n<li><b>1 \u2264 S<sub>i</sub> \u2264 10<sup>6</sup></b></li>\n<li><b>1 \u2264 C<sub>ij</sub> \u2264 N</b></li>\n<li>The summation of sizes of all the <b>K</b> client lists will be less than or equal to <b>10<sup>6</sup></b>.</li>\n<li>Each of the <b>K</b> client lists will satisfy the criteria that they are 'close-knit', as explained above.</li>\n</ul>\n\n\n<h3>Example</h3>\n<pre><b>Input:</b>\n<tt>1\n5 3\n3 1 1 3\n3 2 5 3\n2 1 3\n2 4 1</tt>\n<b>Output:</b>\n<tt>2</tt>\n</pre>\n\n<h3>Explanation</h3>\nThe client lists are {2,3,5}, {1,3} and {1,4}. Arresting Employees 1 and 3 will bring down all the 3 Hawala traders. You can verify that it cannot be done with only 1 arrest. Hence the answer is 2.\n</li>\n",
    "category_name": "main",
    "date_added": "20-12-2016",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6",
    "max_timelimit": "5",
    "problem_status": "unattempted",
    "editorial_url": "https://discuss.codechef.com/problems/AMR16G",
    "problem_tester": null,
    "time": {
        "view_start_date": 1482477554,
        "end_date": 1482487200,
        "practice_submission_allowed": true,
        "visible_start_date": 1793475531,
        "submit_start_date": 1482477554,
        "current": 1537434294
    },
    "user": {
        "username": ""
    }
}