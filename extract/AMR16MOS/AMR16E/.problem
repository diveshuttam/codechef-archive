{
    "problem_code": "AMR16E",
    "problem_author": "admin3",
    "contest_name": "ACM-ICPC Asia-Amritapuri Onsite Mirror Contest 2016",
    "todo": false,
    "problem_author_html_handle": "admin3",
    "problem_name": "Black Money Island",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "",
    "contest_code": "AMR16MOS",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/acm-icpc'>acm-icpc</a>, <a class='problem-tag-small ' href='/tags/problems/admin3'>admin3</a>, <a class='problem-tag-small ' href='/tags/problems/amritapuri'>amritapuri</a>, <a class='problem-tag-small ' href='/tags/problems/graph'>graph</a>, <a class='problem-tag-small ' href='/tags/problems/union-find'>union-find</a>",
    "body": "<p>\nThe Royal Bank of Black Money Island wants to construct ATMs so that the citizens can withdraw black money easily for their day-to-day needs. The capital city can be represented as a number of checkpoints connected by a network of roadways, each of which have ATMs present on them. The capital has somewhat equal distribution of ATMs on the roads. Each roadway has either <b>A</b> ATMs or <b>A + 1</b> ATMs present on it. The capital city is connected, i.e. there exists a path between every pair of checkpoints.\n</p>\n\n<p>\nThe Mayor of Black Money Island thinks that the current network of roads and checkpoints is too complicated. He wants to keep only a subset of the roads and shut the rest down. Formally, he wants to select a subset of these roads such that in the resulting network, there is exactly one way to go from any checkpoint to any other. However, due to monetary restrictions (some very weird ones at that), he wants to select a subset of roads such that there is a total of exactly <b>X</b> ATMs on the selected roads. Since the good people at the bank are busy siphoning black money, they have hired you, the local municipal expert, to help them.\n</p>\n\n<h3>Input</h3>\n<p>The first line of the input contains three space separated integers <b>N</b>, <b>E</b> and <b>A</b>, where <b>N</b> denotes the number of checkpoints, <b>E</b> denotes the number of roads in the city respectively, and <b>A</b> signifies that each road has either <b>A</b> ATMs or <b>A + 1</b> ATMs.</p>\n<p>Each of the next <b>E</b> lines contains three integers <b>U</b>, <b>V</b> and <b>W</b> denoting that there exists a bidirectional road between checkpoints <b>U</b> and <b>V</b> with <b>W</b> ATMs on it. It is guaranteed that <b>U</b> and <b>V</b> are not the same, and that each pair of checkpoints are connected by at most one roadway.\n</p>\n<p>The next line contains an integer <b>Q</b> denoting the number of queries.</p>\n<p>\nEach of the next <b>Q</b> lines contains an integer <b>X</b> denoting the required number of ATMs in the selected road network.\n</p>\n\n\n<h3>Output</h3>\n<p>\nFor each query, you should output <b>2</b> lines. Note that this means that your entire output would be <b>2 * Q</b> lines.\n</p>\n<p>\nThe first line of output for each query should be <b>1</b> if it is possible to find a valid subset of roads satisfying the conditions mentioned above. Otherwise, you should print <b>0</b>.\n</p>\n<p>\nIf there exists a valid subset, you must print the roads used in that subset in the second line. Formally, you must print a set of distinct integers <b>S</b>. <b>S</b> contains <b>P</b> if the <b>Pth</b> edge (1-indexed as per the input) is in the selected road network. If a valid subset doesn't exist, you must print <b>-1</b> on the second line. \n</p>\n<p>\nIf there are multiple solutions, you can output any one of them!\n</p>\n\n<h3>Constraints</h3>\n<ul>\n<li><b>2</b> \u2264 <b>N</b> \u2264 <b>10<sup>5</sup></b></li>\n<li><b>1</b> \u2264 <b>E</b> \u2264 <b>10<sup>5</sup></b></li>\n<li><b>0</b> \u2264 <b>A</b> \u2264 <b>10<sup>9</sup></b></li>\n<li><b>1</b> \u2264 <b>U, V</b> \u2264 <b>N</b></li>\n<li><b>U \u2260 V</b></li>\n<li><b>A</b> \u2264 <b>W</b> \u2264 <b>A + 1</b></li>\n<li><b>1</b> \u2264 <b>Q</b> \u2264 <b>20</b></li>\n<li><b>1</b> \u2264 <b>X</b> \u2264 <b>10<sup>18</sup></b></li>\n<li><b>Each pair of checkpoints are connected by at most one roadway.</b></li>\n</ul>\n\n<h3>Example</h3>\n<pre><b>Input:</b>\n<tt>5 5 5\n1 2 5\n1 3 5\n3 4 6\n3 5 6\n4 5 5\n2\n21\n20\n</tt>\n<b>Output:</b>\n<tt>1\n1 2 3 5\n0\n-1</tt>\n</pre>\n\n<h3>Explanation</h3>\n<p>\nFor the first query, we can take roads <b>1, 2, 3</b> and <b>5</b>. In the resulting network, we can see that there is exactly one path between any 2 checkpoints. The total number of ATMs in this network are <b>5 + 5 + 6 + 5 = 21</b>. Thus, it satisfies all the requirements. Note that <b>1, 2, 4</b> and <b>5</b> is also a valid subset of roads.  \n</p>\n<p>\nFor the second query, it is impossible to satisfy all requirements.\n</p>",
    "category_name": "main",
    "date_added": "20-12-2016",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6",
    "max_timelimit": "1",
    "problem_status": "unattempted",
    "editorial_url": "https://discuss.codechef.com/problems/AMR16E",
    "problem_tester": null,
    "time": {
        "view_start_date": 1482477537,
        "end_date": 1482487200,
        "practice_submission_allowed": true,
        "visible_start_date": 1793475531,
        "submit_start_date": 1482477537,
        "current": 1537434290
    },
    "user": {
        "username": ""
    }
}