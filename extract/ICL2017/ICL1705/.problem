{
    "problem_code": "ICL1705",
    "problem_author": "likecs",
    "contest_name": "International Coding League (Rated)",
    "todo": false,
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;</span><span>likecs</span>",
    "problem_name": "Tree Obsession",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "",
    "contest_code": "ICL2017",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/auxiliary-tree'>auxiliary-tree</a>, <a class='problem-tag-small ' href='/tags/problems/icl2017'>icl2017</a>, <a class='problem-tag-small ' href='/tags/problems/likecs'>likecs</a>, <a class='problem-tag-small ' href='/tags/problems/medium-hard'>medium-hard</a>",
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><p>You will be given as input a tree consisting of <b>N</b> nodes,\nand a cost matrix <b>C</b> of size <b>H x H</b>. The matrix has the property that\n<b>C(i, j) = C(j, i)</b> and <b>C(i, i) = 0</b>.\n\n<p>\nChef is going to ask you <b>Q</b> queries now.</p>\n</p>\n\n<p>\nIn each query, you will be given a set <b>S</b> of <b>k</b> vertices.\nSay <b>S = {V<sub>1</sub>, V<sub>2</sub> ... V<sub>k</sub>}</b>.\nYou will also be given a positive integer <b>X</b>.\nYour task is to find the minimum cost of a subset <b>T</b> of vertices of size <b>X</b>\nsuch that every vertex in <b>T</b> lies on a path between at least one pair of\nvertices in <b>S</b>.</p>\n<p>\nIn other words, if <b>T = {u<sub>1</sub>, u<sub>2</sub>, ... , u<sub>X</sub>}</b>, then\nfor every vertex <b>u<sub>i</sub></b>, there should exist two vertices <b>p</b> and <b>q</b> such that <b>u<sub>i</sub></b> lies on the path between <b>p</b> and <b>q</b> and\nboth <b>p</b>, <b>q</b> belong to <b>S</b>. Note that <b>u<sub>i</sub></b> can be <b>p</b> or <b>q</b> as well.\n</p>\n\n<p>\nFor every vertex <b>y</b>, define the set <b>G<sub>y</sub></b> as the set of all\npairs <b>(i, j)</b> such that <b>y</b> lies on the path between\n<b>V<sub>i</sub></b> and <b>V<sub>j</sub></b> and <b>i <= j</b>.\n</p>\n\n<p>\nThen, the cost of a set <b>T</b> is defined as:\n</p>\n\n<p><a target=\"_blank\" href=\"https://discuss.codechef.com/upfiles/Formula.png\"><img src=\"https://discuss.codechef.com/upfiles/Formula.png\" width=\"50%\" height=\"50%\"/></a></p>\n\n<p>\nNote that for every vertex <b>u</b> in <b>T</b>, <b>G<sub>u</sub></b> has to be non empty.\n</p>\n<p>\nFor every query that Chef poses, return the minimum cost of a set <b>T</b> with\nthe given properties.\n</p>\n\n<p>\n<b>Note:</b> If there doesn't exist any set <b>T</b>, print <b>No</b>.\n</p>\n\n<h3>Input</h3>\n<p>\nThe first input consists of two integers <b>N</b> and <b>H</b>, denoting the\nnumber of nodes in the tree and the size of Cost Matrix <b>C</b>. The nodes of the tree are numbered from <b>1</b> to <b>N</b>.\n</p>\n\n<p>\nThen <b>(N-1)</b> lines follow, each containing 2 integers <b>a</b> and <b>b</b>, denoting that\nthere is an undirected edge between <b>a</b> and <b>b</b> in the tree.\n</p>\n\n<p>\nEach of the next <b>H</b> lines contain <b>H</b> space separated integers, describing the\ncost matrix <b>C</b>. The <b>j<sup>th</sup></b> integer on the <b>i<sup>th</sup></b> line is <b>C[i][j]</b>.\n</p>\n\n<p>\nNext line contains a single integer <b>Q</b>, denoting the number of queries.\n</p>\n<p>\nThen <b>2*Q</b> lines follow.\nThe first line of each query contains 2 integers <b>k</b> and <b>X</b>,\nas specified in the problem. The second\nlines contains <b>k</b> space separated integers denoting the set S.</p>\n</p>\n\n<h3>Output</h3>\n<p>For each query, print the required <b>-1</b> or the minimum cost as specified in the problem.</p>\n\n<h3>Constraints</h3>\n1 &le; <b>N</b> &le; 10<sup>5</sup><br />\n1 &le; <b>Q</b> &le; 10<sup>5</sup><br />\n1 &le; <b>k</b> &le; <b>min(N, H)</b><br />\n1 &le; <b>H</b> &le; 15<br />\n1 &le; <b>X</b> &le; <b>N</b><br />\n-10000 &le; <b>C<sub>i</sub><sub>j</sub></b> &le; 10000, where <b>C<sub>i</sub><sub>j</sub></b> denotes values in Cost matrix\n\n<h3>Sample Input</h3>\n<pre>\n8 3\n1 2\n2 3\n2 4\n1 5\n5 6\n5 7\n7 8\n0 1 2\n1 0 -2\n2 -2 0\n3\n3 2\n3 6 4\n2 2\n2 3\n1 2\n8\n</pre>\n\n<h3>Sample Output</h3>\n<pre>\n-2\n2\nNo\n</pre>\n\n<h3>Explanation</h3>\n\n<p>\nThe graph for the sample test case is given below, with the input vertices\nfor the first query marked in yellow.\n\n<p><a target=\"_blank\" href=\"https://codechef_shared.s3.amazonaws.com/download/HYC/External%20contest%20images/ICL2017/BITS-P/Sample%20Graph.png\"><img src=\"https://codechef_shared.s3.amazonaws.com/download/HYC/External%20contest%20images/ICL2017/BITS-P/Sample%20Graph.png\" width=\"100%\" /></a></p>\n\nFor the first query, we need to find a set <b>T</b> of size two such that each\nvertex <b>u</b> in <b>T</b> lies on a path between <b>a</b>\nand <b>b</b> where both <b>a</b> and <b>b</b>\nbelong to <b>S = {3, 6, 4}</b>, and the cost of <b>T</b> is minimum.\n</p>\n\n<p>\nFor this query, the optimal answer either the set <b>T = {1, 6}</b> or <b>T = {5, 6}</b> or <b>T = {1, 5}</b>.\n</p>\n<p>\nThe set <b>G<sub>1</sub> = {(0, 1), (1, 2)}</b> and\n<b>G<sub>6</sub> = {(0, 1), (1, 1), (1, 2)}</b>. Hence the cost corresponding\nto <b>T = {1, 6}</b> is\n<b>\n(C[0][1] + C[1][2]) + (C[0][1] + C[1][1] + C[1][2])\n</b>\nwhich is equal to\n<b>\n(1 + (-2)) + (1 + 0 + (-2)) = -2\n</b>\n</p>\n",
    "category_name": "main",
    "date_added": "26-03-2017",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS",
    "max_timelimit": "3",
    "problem_status": "unattempted",
    "editorial_url": "https://discuss.codechef.com/problems/ICL1705",
    "problem_tester": null,
    "time": {
        "view_start_date": 1490542200,
        "end_date": 1490553000,
        "practice_submission_allowed": true,
        "visible_start_date": 1490553000,
        "submit_start_date": 1490542200,
        "current": 1537433960
    },
    "user": {
        "username": ""
    }
}