{
    "problem_code": "GST",
    "problem_author": "friggstad",
    "contest_name": "May 2010 Contest",
    "todo": false,
    "problem_author_html_handle": "friggstad",
    "problem_name": "Generalized Spanning Trees",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;</span><span>keshav_57</span>",
    "contest_code": "MAY10",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/friggstad'>friggstad</a>, <a class='problem-tag-small ' href='/tags/problems/hard'>hard</a>, <a class='problem-tag-small ' href='/tags/problems/may10'>may10</a>",
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><p>\nA spanning tree of an undirected, connected graph (V,E) with vertex set V and edge set E is a subset of edges F such that the graph (V,F) is connected and has no cycles. After a few moments thought, one realizes that an equivalent way to say this is to say:\n<ul>\n   <li>1) |F| = |V| - 1</li>\n   <li>2) For any non-empty subset of nodes S, the number of edges with <b>both</b> endpoints in S is does not exceed |S|-1.</li>\n</ul>\n</p><p></p><p>\nThere is a fairly simple algorithm that can determine if a set of edges F is indeed a spanning tree of a graph.  Simply check that |F| = |V| - 1 and that the graph (V,F) is connected using your favorite connectivity algorithm.\n\n</p><p>\nAs in all topics in mathematics, the next step is to generalize what is known.  So, consider the following generalization of spanning trees.  Say a generalized spanning tree (GST) of a graph (V,E) is a function f from the set of edges E = {e<sub>1</sub>, e<sub>2</sub>, ..., e<sub>M</sub>} to the real interval [0,1] such that the following conditions hold:\n<ul>\n   <li>1) f(e<sub>1</sub>) + f(e<sub>2</sub>) + ... + f(e<sub>M</sub>) = |V| - 1</li>\n   <li>2) For any non-empty subset of nodes S, the sum of the f(e) values for edges e with <b>both</b> endpoints in S does not exceed |S|-1.</li>\n</ul>\n</p><p></p><p>\nOne can see that this generalizes the notion of a spanning tree since spanning trees (in the classical sense) correspond to GSTs by setting f(e) = 1 if e is in the spanning tree and f(e) = 0 if e is not in the spanning tree.\n\n</p><p>\nYour task is to determine if a given function is a GST of a given graph.\n\n<h3>Input:</h3>\n</p><p>\nThe first line contains a single integer T (about 20) indicating the number of test cases to follow.\n\n</p><p>\nEach test case begins with two integers N and M where N is the number of nodes and M is the number of edges. The following M lines describe the edges, one per line. Each line contains three values u, v, f where 1 &lt;= u, v &lt;= n are the endpoints of the edge and f is a rational number between 0 and 1 (inclusive).  This rational number is the value of the edge in the proposed GST.\n\n</p><p>\nThe rational numbers are always presented as n/d (even if d=1) where both n and d are non-negative and have no common factors.\n\n</p><p>\nThe input graphs have no parallel edges or loops and are, of course, undirected. Consecutive cases will be separated by a blank line (including a blank line preceding the first case).\n\n</p><p>\nBounds: 2 &lt;= N &lt;= 50, 1 &lt;= M &lt;= 100, and no denominator of any fraction in the input exceeds 30.\n\n<h3>Output:</h3>\n</p><p>\nIf the function is a GST, you are to simply print a single line saying \"GST\".\n\n</p><p>\nIf the first constraint (the sum of the values of all edges is N-1) is violated, then you should print a single line displaying just the number 1.\n\n</p><p>\nOtherwise, if constraint 1) holds but constraint 2) is violated for some non-empty set S, you should print three lines. The first line simply contains the integer 2. The second contains the size of a non-empty \nsubset of the nodes whose corresponding constraint is violated. The third line lists the nodes (in any order) that are part of such a set with a violated constraint (the number of nodes is as reported in the second line).\n\n</p><p>\nIf there are multiple non-empty sets whose constraints are violated, then any will do. Print a blank line after the output for each case.\n\n<h3>Example:</h3>\n<h3>Input:</h3>\n<pre>\n3\n\n3 3\n1 2 2/3\n2 3 2/3\n3 1 2/3\n\n3 3\n1 2 1/1\n2 3 1/1\n3 1 1/1\n\n4 6\n1 2 1/5\n1 3 1/5\n1 4 1/5\n2 3 4/5\n2 4 4/5\n3 4 4/5\n</pre>\n\n<h3>Output:</h3>\n<pre>\nGST\n\n1\n\n2\n3\n2 3 4\n</pre></p>",
    "category_name": "main",
    "date_added": "10-04-2010",
    "status": "success",
    "languages_supported": "C, JAVA, PYTH, CS2, PAS fpc, PAS gpc, RUBY, PHP, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TEXT",
    "max_timelimit": "1.07916",
    "problem_status": "unattempted",
    "editorial_url": "http://discuss.codechef.com/problems/GST",
    "problem_tester": "keshav_57",
    "time": {
        "view_start_date": 1272706200,
        "end_date": 1273656600,
        "practice_submission_allowed": true,
        "visible_start_date": 1273656600,
        "submit_start_date": 1272706200,
        "current": 1537439579
    },
    "user": {
        "username": ""
    }
}