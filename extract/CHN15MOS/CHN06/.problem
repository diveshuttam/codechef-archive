{
    "problem_code": "CHN06",
    "problem_author": "admin2",
    "contest_name": "ACM-ICPC Asia-Chennai Onsite Mirror Contest 2015",
    "todo": false,
    "problem_author_html_handle": "admin2",
    "problem_name": "King Animesh decides to have a voyage to the sun",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "",
    "contest_code": "CHN15MOS",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/acm15chn'>acm15chn</a>, <a class='problem-tag-small ' href='/tags/problems/admin2'>admin2</a>, <a class='problem-tag-small ' href='/tags/problems/graph-traversal'>graph-traversal</a>, <a class='problem-tag-small ' href='/tags/problems/perfect-match'>perfect-match</a>",
    "body": "<p>\nKing Animesh has decided to go on a voyage to the Sun. He has decided to take only one of his courtiers with him. Everyone knows that the king has two favorite courtiers, Arjun and Praveen, and so they are competing between themselves to go with the King. Arjun is a great archer, so he has decided to impress the king by demonstrating his perfect abilities. Praveen is smart, he knows exactly what the King likes - Graphs of Perfection.\nGraphs of Perfection are weighted complete bipartite graphs with <b>2*N</b> vertices, which have a property that <b>every Perfect Matching in the graph has the same cost</b>. The cost of a Perfect Matching is just the sum of costs of all the <b>N</b> edges in it.\n</p>\n\n<p>\nSuch graphs are rare, but Praveen had found one in the Forest of Perfection and he had kept it carefully in a box. The <b>N</b> nodes in the left column are labelled <b>{1,2, \u2026 ,N}</b>, and the <b>N</b> nodes in the right column are labelled <b>{N+1, N+2, \u2026 , 2*N}</b>. The cost associated with an edge between node <b>u</b> in left column and node <b>v</b> in right column, is denoted by <b>C<sub>u</sub><sub>v</sub></b>.\n</p>\n\n<p>\nUnfortunately, when it is Praveen's turn to present the graph to the King, he realizes that his rival Arjun has made a hole in the box and as a result, some of the edges have fallen off. He tries to remain calm and presents the graph to the King claiming that he can assign costs to the missing edges in such a way that the graph becomes a Graph of Perfection again. Praveen knows that the remaining edges have a magical property - <b>there is a unique way to assign costs to the missing edges such that the graph becomes a Graph of Perfection</b>. But he doesn't tell that to the King, and so the King gets highly impressed by his claim and tells him to report the sum of the squares of all the <b>N<sup>2</sup></b> edge costs modulo <b>10<sup>9</sup>+7</b>. Alas! Praveen is not <em>that</em> smart, but we hope you are! You are given the costs of the edges which are still in the box; please help Praveen find the required sum.\n</p>\n\n<p>\n<b>Note:</b>\n<ul>\n<li>A complete bipartite graph means that there is an edge between every node in the left column and every node in the right column.</li>\n<li>A Perfect Matching in this graph is a set of <b>N</b> edges such that no two edges among them have any end point in common.</li>\n</ul>\n</p>\n\n<h3>Input</h3>\n<ul>\n<li>The first line contains two integers: <b>N</b> and <b>E</b>.</li>\n<li>The next <b>E</b> lines of the test case contain three integers each: <b>u</b>, <b>v</b> and <b>x</b>. This signifies Praveen knows the cost of the edge from vertex <b>u</b> in the left column to the vertex <b>v</b> in the right column, and that cost is equal to <b>x</b>. That is, <b>C<sub>u</sub><sub>v</sub></b> = <b>x</b></li>\n<li>It is guaranteed that there is a unique way to assign costs to the missing edges such that the given graph in the input becomes a Graph of Perfection.</li>\n</ul>\n\n<h3>Output</h3>\n<ul>\n<li>For each test case, output a single integer in a line, corresponding to the answer of the problem.</li>\n</ul>\n</ul>\n\n\n<h3>Constraints</h3>\n<ul>\n<li>1 &le; <b>N</b> &le; <b>10<sup>5</sup></b></li>\n<li>1 &le; <b>E</b> &le; <b>10<sup>6</sup></b></li>\n<li>1 &le; <b>u</b> &le; <b>N</b></li>\n<li><b>N+1</b> &le; <b>v</b> &le; <b>2*N</b></li>\n<li>1 &le; <b>x</b> &le; <b>10<sup>5</sup></b>, but note that the edge costs which are not in the input need not satisfy this constraint. That is, this constraint does not apply for the missing edges.</li>\n</ul>\n\n\n<h3>Example</h3>\n<pre><b>Input:</b>\n2 3\n1 3 2\n1 4 3\n2 3 5\n\n<b>Output:</b>\n74\n</pre>\n\n<h3>Explanation</h3>\n<p>\nOut of the 4 edges, the costs of 3 edges are already given to us. The edge (2, 4) must cost 6 to satisfy the \"All Perfect Matchings should have equal costs\" constraint. Therefore, now, the sum of the squares of the costs of all the 4 edges is (2<sup>2</sup> + 3<sup>2</sup> + 5<sup>2</sup> + 6<sup>2</sup>) = (4 + 9 + 25 + 36) = 74\n</p>",
    "category_name": "main",
    "date_added": "17-01-2016",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA",
    "max_timelimit": "1",
    "problem_status": "unattempted",
    "editorial_url": "https://discuss.codechef.com/problems/CHN06",
    "problem_tester": null,
    "time": {
        "view_start_date": 1453528800,
        "end_date": 1453546800,
        "practice_submission_allowed": true,
        "visible_start_date": 1764568884,
        "submit_start_date": 1453528800,
        "current": 1537435618
    },
    "user": {
        "username": ""
    }
}