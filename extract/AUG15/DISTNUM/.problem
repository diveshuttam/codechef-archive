{
    "problem_code": "DISTNUM",
    "problem_author": "mgch",
    "contest_name": "August Challenge 2015",
    "todo": false,
    "problem_author_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;</span><span>mgch</span>",
    "problem_name": "Simple Queries",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;</span><span>laycurse</span>",
    "contest_code": "AUG15",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/2d'>2d</a>, <a class='problem-tag-small ' href='/tags/problems/aug15'>aug15</a>, <a class='problem-tag-small ' href='/tags/problems/fenwick-tree'>fenwick-tree</a>, <a class='problem-tag-small ' href='/tags/problems/mgch'>mgch</a>, <a class='problem-tag-small ' href='/tags/problems/range-tree'>range-tree</a>, <a class='problem-tag-small ' href='/tags/problems/segment-tree'>segment-tree</a>, <a class='problem-tag-small ' href='/tags/problems/sqrt-decomp'>sqrt-decomp</a>, <a class='problem-tag-small ' href='/tags/problems/super-hard'>super-hard</a>",
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><h3> Read problems statements in <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/AUG15/mandarin/DISTNUM.pdf\">Mandarin Chinese </a> and <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/AUG15/russian/DISTNUM.pdf\">Russian</a>.</h3>\n<p>Given an array <b>A</b> consisting of <b>N</b> positive integers, and <b>Q</b> queries on it. The queries can be of five types: </p>\n<ul>\n<li><b>1 l r</b> - let <b>S</b> - sorted set of elements with indices between <b>l</b> and <b>r</b>. You need to find: </li>\n<p><img width = \"380\" height = \"100\" src=\"http://www.codechef.com/download/AUG15/DISTNUM.png\" /></p>\n<li><b>2 x y</b> - assign the value <b>y</b> to element at position <b>x</b>. </li>\n<li><b>3 x</b> - delete element at position <b>x</b> from array. </li>\n<li><b>4 z y</b> - insert <b>y</b> after element at position <b>z</b>. If <b>z</b> equal 0 then <b>y</b> should insert before the first element. </li>\n<li><b>5 l r</b> - count the number of distinct numbers in array between indices <b>l</b> and <b>r</b>. </li>\n</ul>\n<p></p>\n<p>All the indices in the queries are 1-based.</p>\n<p>Array always contains at least one element.</p>\n<h3>Input</h3>\n<p>The first line of input contains two integers <b>N</b> and <b>Q</b> denoting the number of elements in <b>A</b>, and the number of queries to be executed. The second line of input contains <b>N</b> integers denoting the array <b>A</b>. Each of the next <b>Q</b> lines contains one query.</p>\n<h3>Output</h3>\n<p>For each query of <b>type 1</b> or <b>type 5</b>, output the answer to the query in a single line.</p>\n<h3>Constraints</h3>\n<ul>\n<li><b>1</b> \u2264 <b>N, Q</b> \u2264 <b>10<sup>5</sup></b></li>\n<li><b>1</b> \u2264 <b>A</b><sub>i</sub>, <b>y</b> \u2264 <b>10<sup>9</sup> + 6</b></li>\n<li><b>1</b> \u2264 <b>x </b> \u2264 <b>|A|</b></li>\n<li><b>1</b> \u2264 <b>l </b> \u2264 <b> r </b> \u2264 <b>|A|</b></li>\n<li><b>0</b> \u2264 <b>z </b> \u2264 <b>|A|</b></li>\n</ul>\n<h3>Example</h3>\n<pre><b>Input:</b>\n5 8\n1 2 3 2 1\n1 1 3\n5 1 5\n2 2 4\n1 2 4\n3 3\n4 0 5\n1 1 2\n1 1 5\n\n<b>Output:</b>\n6\n3\n24\n0\n78\n\n<b>Input:</b>\n10 15\n5 4 3 5 4 1 5 4 3 1\n2 8 580347\n4 6 503576\n1 2 5\n5 8 11\n1 2 6\n4 7 565239\n3 6\n3 11\n3 3\n2 9 674360\n1 1 6\n2 2 589693\n4 5 236488\n1 8 9\n5 2 7\n\n\n<b>Output:</b>\n60\n4\n107\n788510349\n0\n6\n\n</pre><h3>Subtasks</h3>\n<ul>\n<li><b>Subtask 1:</b> <b>Q</b>*<b>N </b>\u2264 2*10<sup>7</sup>. <b>Points - 10</b></li>\n<li><b>Subtask 2:</b> Queries are of type 5 only. <b>Points - 5</b></li>\n<li><b>Subtask 3:</b> Queries are of type 1 only. <b>Points - 10</b></li>\n<li><b>Subtask 4:</b> Queries are of types 2, 5 only. <b>Points - 15</b></li>\n<li><b>Subtask 5:</b> Queries are of types 1, 2, 5 only. <b>N, Q</b> \u2264 50000 <b>Points - 15</b></li>\n<li><b>Subtask 6:</b> Queries are of types 2, 3, 4 only. <b>Points - 5</b></li>\n<li><b>Subtask 7:</b> <b>N, Q</b> \u2264 50000. <b>Points - 10</b></li>\n<li><b>Subtask 8:</b> Original constraints. <b>Points - 30</b></li>\n</ul>\n<h3>Explanation</h3>\n<p><b>Query 1</b> Sorted set of elements with positions between 1 and 3 is S = {1, 2, 3}, ans = 1 * 2 * 3 = 6.</p>\n<p><b>Query 2</b> Set of elements with positions between 1 and 5 is S = {1, 2, 3}, ans = |S| = 3.</p>\n<p><b>Query 3</b> After this query A = {1, 4, 3, 2, 1}.</p>\n<p><b>Query 4</b> Sorted set of elements with positions between 2 and 4 is S = {2, 3, 4}, ans = 2 * 3 * 4 = 24.</p>\n<p><b>Query 5</b> After this query A = {1, 4, 2, 1}.</p>\n<p><b>Query 6</b> After this query A = {5, 1, 4, 2, 1}.</p>\n<p><b>Query 7</b> Sorted set of elements with positions between 1 and 2 is S = {1, 5}, ans = 0.</p>\n<p><b>Query 8</b> Sorted set of elements with positions between 1 and 5 is S = {1, 2, 4, 5}, ans = 1 * 2 * 4 + 1 * 2 * 5 + 2 * 4 * 5 + 1 * 4 * 5 = 78.</p>\n",
    "category_name": "main",
    "date_added": "17-07-2015",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS",
    "max_timelimit": "2",
    "problem_status": "unattempted",
    "editorial_url": "http://discuss.codechef.com/problems/DISTNUM",
    "problem_tester": "laycurse",
    "time": {
        "view_start_date": 1438939800,
        "end_date": 1439803800,
        "practice_submission_allowed": true,
        "visible_start_date": 1439803800,
        "submit_start_date": 1438939800,
        "current": 1537436131
    },
    "user": {
        "username": ""
    }
}