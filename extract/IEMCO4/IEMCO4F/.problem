{
    "status": "success",
    "problem_status": "unattempted",
    "problem_tester": null,
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><b>Problem:</b>\n<br>\n<p>Saltlake City in West Bengal is one of the place where most of the IT Sector resides. People rush towards their office in morning and traffic around the Saltlake area is mostly busy during the week days.</p>\n<p>In order to handle the heavy traffic, Transportation authority has decided to re-calculate the bus fares between different locations around the Saltlake area.</p>\n<p>The entire map of Saltlake area is represented in the form of a tree i.e. there exists a single and distinct route between two different locations. There exists <b>n</b> locations, and <b>previously existing fare</b> between two\ndirectly connected locations are provided.\nShrirupa has been appointed as a Chairman of Transporation Authority. As a responsible person, she devised a method to recalculate the existing fare between two directly connected locations. Method is as follows:\n\n<br><br><b>New fare = max(50_bit_representation of existing fare) XOR min(50_bit_representation of existing fare). </b>To be more elaborate,<br>\n\n<b>50_bit_representation of a number \"X\" = Binary representation of Decimal number \"X\" which should have exactly 50 bits in Binary form.</b><br> For example, 10 will be represented as:\n\n            <b>  \"0000000000.....0001010\"</b> , which consists 46 Leading Zeroes. We can have different permutations for this 50_bit_representation.\n\n<br><b>max(50_bit_representation of a number \"X\") = maximum of all Permutations of 50_bit_representation of given number \"X\". Similarly min(50_bit_representation of a number \"X\") is defined</b>.</p>\n\n<p>Sometimes, due to un-avoidable circumstances, an update of fare between two directly connected locations are done.Since there are many locations ,its tough for Shrirupa to maintain and update records and respond to\ncommon people query. Hence Shrirupa needs your help.</p>\n\n<p>Shrirupa has simplified your work by declaring that she will only answer query regarding maximum fare between two different locations.As a wise apprentice, you are provided with tree structure of Saltlake and previously\nexisting fare between two directly connected locations.</p>\n<p>\nYou have to do following types of operation as an apprentice :\n\n<br>1. Update the fare between two directly connected locations according to new devised method.\n<br>2. Output the maximum fare between two different locations.\n\n<br><br><b>Note : Every query of type 2 must be answered according to new devised method.\n<br>Note : It is guaranteed that number of active bits in input \"fares\" < 50.</b>\u00a0</p></p>\n\n\n<h3>Input</h3>\n<p></p>\n<ul>\n<li>First line consists of an integer <b>T</b> , denoting number of testcases.</li>\n<li>First line of each testcase consists of a single integer <b>N</b> , denoting number of locations.</li>\n<li>Next n-1 lines consists of 3 space separated integers <b>u</b> ,<b>v</b> and <b>f</b> , where <b>u</b> and <b>v</b> denotes two                                      directly connected locations and <b>f</b> denotes the previously existing fare between <b>u</b> and <b>v</b>.</li>\n<li>Next line consists of a single integer <b>Q</b>, denoting number of queries.</li>\n<li>Next Q lines consists of queries of following types:\n<ul>\n<li>1 j r , where 1 is query of type 1 and <b>j</b> denotes jth edge of input and <b>r</b> is fare which needs to be updated on jth edge as per new devised method.</li>\n<li>2 x y , where 2 is query of type 2 and <b>x</b>, <b>y</b> denotes two different locations for which we have to answer maximum fare between these two locations.</li>\n </li>\n</ul>\n</ul>\n<p></p>\n\n<h3>Output</h3>\n<p></p>\n<ul>\n<li>\nFor each query of type 2, output the required answer in a separate line.</li>\n</ul>\n<p>\u00a0</p>\n\n<h3>Constraints</h3>\n<p></p>\n<ul>\n<li><b>1</b> \u2264 <b> T </b> \u2264 <b>10</b></li>\n<li><b>1</b> \u2264 <b>N</b> \u2264 <b>10^5</b></li>\n<li><b>1</b> \u2264 <b>u,v</b> \u2264 <b>N</b></li>\n<li><b>1</b> \u2264 <b>f,r</b> \u2264 <b>10^9</b></li>\n<li><b>1</b> \u2264 <b>Q</b> \u2264 <b>10^5</b></li>\n<li><b>1</b> \u2264 <b>x,y</b> \u2264 <b>N</b></li>\n<li><b>1</b> \u2264 <b>j</b> \u2264 <b>N-1</b></li>\n</ul>\n<p>\u00a0</p>\n<h3>Example</h3>\n<pre><b>Input:</b>\n\n1\n15\n8 1 4\n12 2 2\n6 3 4\n14 4 8\n2 5 9\n11 6 8\n5 7 8\n2 8 5\n10 9 3\n3 10 7\n3 12 8\n11 13 4\n3 14 1\n12 15 1\n6\n2 1 7\n2 9 11\n1 3 6\n1 10 2\n2 15 9\n2 2 4\n\n<b>Output:</b>\n\n844424930131971\n985162418487303\n844424930131971\n562949953421313\n\n</pre>\n<br>\n<h3>Explanation</h3>\n\nExplanation for above input output is not provided here. Instead, let us assume that we are given with 5_bit_representation(not as per question, just for understanding purpose) and following is Input output:\n<br><br>\n<pre><b>Input:</b>\n1\n9\n1 2 3\n2 7 7\n1 3 5\n3 4 30\n4 6 2\n3 5 15\n5 8 6\n5 9 31\n5\n2 1 6\n2 6 9\n1 8 1\n1 4 10\n2 6 9\n\n<b>Output:</b>\n\n27\n17\n27\n\n<br>Now, try to figure out yourself, how 5_bit_representation is working. Similarly, it will work for 50 bit.\n</pre>\n",
    "category_name": "main",
    "user": {
        "username": ""
    },
    "date_added": "2-11-2017",
    "is_direct_submittable": false,
    "contest_name": "IEM Coding Olympiad (IEMCO)",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, CLOJ, COB, FS",
    "todo": false,
    "time": {
        "view_start_date": 1509805800,
        "end_date": 1509816600,
        "practice_submission_allowed": true,
        "visible_start_date": 1509816600,
        "submit_start_date": 1509805800,
        "current": 1537433376
    },
    "problem_author_html_handle": "tkh_iem",
    "problem_name": "Wise Apprentice",
    "source_sizelimit": "50000",
    "tags": "<a class='problem-tag-small ' href='/tags/problems/tkh_iem'>tkh_iem</a>",
    "problem_tester_html_handle": "",
    "problem_author": "tkh_iem",
    "contest_code": "IEMCO4",
    "max_timelimit": "1",
    "problem_code": "IEMCO4F"
}