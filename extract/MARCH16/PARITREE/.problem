{
    "problem_code": "PARITREE",
    "problem_author": "admin2",
    "contest_name": "March Challenge 2016",
    "todo": false,
    "problem_author_html_handle": "admin2",
    "problem_name": "Parity tree",
    "source_sizelimit": "50000",
    "problem_tester_html_handle": "<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;</span><span>kevinsogo</span>",
    "contest_code": "MARCH16",
    "is_direct_submittable": false,
    "tags": "<a class='problem-tag-small ' href='/tags/problems/admin2'>admin2</a>, <a class='problem-tag-small ' href='/tags/problems/bicolor'>bicolor</a>, <a class='problem-tag-small ' href='/tags/problems/graph'>graph</a>, <a class='problem-tag-small ' href='/tags/problems/march16'>march16</a>, <a class='problem-tag-small ' href='/tags/problems/medium'>medium</a>, <a class='problem-tag-small ' href='/tags/problems/union-find'>union-find</a>, <a class='problem-tag-small ' href='/tags/problems/xor'>xor</a>",
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><h3> Read problems statements in <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/MARCH16/mandarin/PARITREE.pdf\">Mandarin Chinese</a>, <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/MARCH16/russian/PARITREE.pdf\">Russian</a> and <a target=\"_blank\" href=\"http://www.codechef.com/download/translated/MARCH16/vietnamese/PARITREE.pdf\">Vietnamese</a> as well.</h3>\n<p>\nYou are given a tree consisting of <b>n</b> nodes numbered from <b>1</b> to <b>n</b>. The weights of edges of the tree can be any <b>binary</b> integer satisfying following <b>Q</b> conditions.</p>\n<ul>\n<li>\n\t\tEach condition is of form <b>u, v, x</b> where <b>u, v</b> are nodes of the tree and <b>x</b> is a binary number. <br />\n\t\tFor satisfying this condition,  sum of the weight of all the edges present in the path from node <b>u</b> to <b>v</b> of the tree, should have even if <b>x = 0</b>, odd otherwise.\n\t</li>\n</ul>\n\n<p>\nNow, you have to find out number of ways of assigning <b>0/1</b> (binary) weights to the edges of the tree satisfying the above conditions.<br />\nAs the answer could be quite large, print your answer modulo <b>10<sup>9</sup> + 7</b>.\n</p>\n<h3>Input</h3>\n<ul>\n<li>The first line of input contains a single integer <b>T</b> denoting number of test cases.</li>\n<li>For each test case:\n<ul>\n<li>First line contains two space separated integers <b>n, Q</b>.</li>\n<li>Each of the next <b>n - 1</b> lines will contain two space separated integer  <b>u, v</b> denoting that there is an edge between vertex <b>u</b> and <b>v</b> in the tree.</li>\n<li>Each of the next <b>Q</b> lines will contain three space separated integer  <b>u, v, x</b> denoting a condition as stated in the probelm.</li>\n</ul>\n</li>\n</ul>\n<h3>Output</h3>\n<ul>\n<li>For each test case, output a single integer corresponding to the answer of the problem.\n</li></ul>\n\n<h3>Constraints</h3>\n<ul>\n<li>1 \u2264 <b>u, v</b> \u2264 <b>n</b></li>\n<li>0 \u2264 <b>x</b> \u2264 <b>1</b></li>\n</ul>\n<h3>Subtasks</h3>\n<p>\n<b>Subtask #1 : (10 points)</b></p>\n<ul>\n<li>Sum of each of variables <b>n</b> and <b>Q</b> over all the test cases \u2264 <b>20</b></li>\n</ul>\n\n<p>\n<b>Subtask #2 : (20 points)</b></p>\n<ul>\n<li>Sum of each of variables <b>n</b> and <b>Q</b> over all the test cases \u2264 <b>100</b></li>\n</ul>\n\n<p>\n<b>Subtask #3 : (30 points)</b></p>\n<ul>\n<li>Sum of each of variables <b>n</b> and <b>Q</b> over all the test cases \u2264 <b>5000</b></li>\n</ul>\n\n<p>\n<b>Subtask #4 : (40 points)</b></p>\n<ul>\n<li>Sum of each of variables <b>n</b> and <b>Q</b> over all the test cases \u2264 <b>100000</b></li>\n</ul>\n\n<h3>Example</h3>\n<pre><b>Input:</b>\n3\n3 2\n1 2\n1 3\n1 2 0\n1 3 0\n3 0\n1 2\n2 3\n3 1\n1 2\n2 3\n1 2 1\n\n<b>Output:</b>\n1\n4\n2\n</pre><h3>Explanation</h3>\n<p><b>In the first example</b>,<br />\nYou can only set the weight of each edge equal to 0 for satisfying the given condition. So, there is exactly one way of doing this. Hence answer is 1.\n</p>\n<p><b>In the second example</b>,<br />\nThere are two edges and there is no condition on the edges. So, you can assign them in 4 ways.\n</p>\n<p><b>In the third example</b>,<br />\nYou have to assign the weight of edge between node 1 and 2 to 1. You can assign the remaining edge from 2 to 3 either 0 or 1. So, the answer is 2.\n</p>\n",
    "category_name": "main",
    "date_added": "9-02-2016",
    "status": "success",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, SCALA, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, PERL6, TEXT, SCM chicken, CLOJ, FS",
    "max_timelimit": "1",
    "problem_status": "unattempted",
    "editorial_url": "http://discuss.codechef.com/problems/PARITREE",
    "problem_tester": "kevinsogo",
    "time": {
        "view_start_date": 1457083800,
        "end_date": 1458034200,
        "practice_submission_allowed": true,
        "visible_start_date": 1458034200,
        "submit_start_date": 1457083800,
        "current": 1537435112
    },
    "user": {
        "username": ""
    }
}