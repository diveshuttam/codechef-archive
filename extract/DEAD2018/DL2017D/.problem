{
    "status": "success",
    "problem_status": "unattempted",
    "problem_tester": null,
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><h2 id=\"sec1\" class=\"section\">Introduction</h2>\n<p>\n    Old MacBeetle, having made quite a\u00a0fortune on the\u00a0trade in\u00a0munitions from\u00a0his many factories,\n    decided at last to\u00a0head into his well-deserved retirement and devote himself completely\n    to growing radishes \u2013 his true passion. Before doing so, however, he must hand over the\u00a0reins to\u00a0the\u00a0younger\n    generation.\n    MacBeetle intends to\u00a0divide all of\u00a0his factories fairly between his <b>N</b> sons. With this purpose\n    in mind, he spread a\u00a03D\u00a0map of\u00a0the part of\u00a0the Universum under his control before him and divided\n    it into equal cubic zones. He decided that each of\u00a0his sons will supervise all factories in\u00a0one\n    connected region built with of\u00a0a number of\u00a0such zones. MacBeetle wants to\u00a0encourage his successors\n    to cooperate, therefore each region must adjoin at least <b>R</b> other regions. Moreover, he doesn\u2019t want\n    to favor anybody, that is why he is particularly keen on all the\u00a0regions being of\u00a0similar size\n    and bringing similar profits as the\u00a0adjoining ones.</p>\n<h2 id=\"sec3\" class=\"section\">Problem</h2>\n<p>\n    MacBeetle controls factories in\u00a0the part of\u00a0the Universum shaped as a\u00a0cuboid with dimensions <b>A</b> \u00d7 <b>B</b> \u00d7\n    <b>C</b>,\n    divided into\u00a0<b>A</b> \u00b7 <b>B</b> \u00b7 <b>C</b> cubic zones. Each zone was assigned one integer denoting a\u00a0cumulated\n    average profit\n    (or loss, when the\u00a0number is negative) from\u00a0factories located there. All zones should be distributed between\n    <b>N</b> sons,\n    creating <b>N</b>\u00a0regions (one for\u00a0each son) in\u00a0such a\u00a0manner that each region:\n</p>\n<ul class=\"itemize\">\n    <li class=\"li-itemize\">\n        is connected (two zones are adjoining, if they have one common face),\n    </li>\n    <li class=\"li-itemize\">consists of\u00a0a proper number of\u00a0zones: in\u00a0the closed interval between <b>m</b> and <b>M</b> \u2013\n        [<b>m</b>, <b>M</b>],\n    </li>\n    <li class=\"li-itemize\">adjoins at least <b>R</b> other regions (region <b>A</b> adjoins region <b>B</b>,\n        if at least one zone of\u00a0the region A\u00a0adjoins one zone of\u00a0the region B),\n    </li>\n</ul>\n<p>\n    MacBeetle wants the\u00a0division to\u00a0be as fair as possible. Therefore,\n    he defined the\u00a0value of\u00a0a\u00a0region as a\u00a0sum of\u00a0values of\u00a0all zones constituting\n    the region and decided that the\u00a0smaller the\u00a0sum of\u00a0nonnegative differences of\u00a0values of\u00a0adjoining regions,\n    the\u00a0better the\u00a0division.</p>\n\n<h2 id=\"sec5\" class=\"section\">Input data</h2>\n<p>\n    The\u00a0first line of\u00a0the test set includes one integer <b>T</b> denoting the\u00a0number of\u00a0tests.\n    The following lines include descriptions of\u00a0tests.</p>\n<p>The\u00a0first line of\u00a0the description of\u00a0each test includes three integers: <b>A</b>, <b>B</b> and <b>C</b>\n    denoting respectively the\u00a0width, length and height of\u00a0the cuboid.</p>\n<p>Next, there are integer values\u00a0<b>v</b> of\u00a0all zones <b>A</b> \u00b7 <b>B</b> \u00b7 <b>C</b>.\n    They are expressed as <b>B</b> \u00b7 <b>C</b> lines, <b>A</b> numbers each.\n    The first <b>B</b> lines describe values at the\u00a0height\n    of\u00a01, the\u00a0following <b>B</b> lines describe values\n    at the\u00a0height of\u00a02, and so forth, up to\u00a0the\u00a0height of\u00a0<b>C</b>.</p>\n<p>Following this description, in\u00a0the next line there are 4 integers:\n    <b>N</b>, <b>m</b>, <b>M</b>, <b>R</b> denoting respectively: the\u00a0number of\u00a0regions the\u00a0whole map must be divided\n    into;\n    a minimum number of\u00a0zones one region can consist of;\n    a maximum number of\u00a0zones one region can consist of;\n    a minimum number of\u00a0neighbors of\u00a0each of\u00a0the created regions.</p>\n<p>All values given in\u00a0one line should be separated with single spaces.</p>\n<table class=\"display dcenter\">\n    <tr>\n        <td class=\"dcell\">\n            <table class=\"cellpading0\">\n                <tr>\n                    <td>\u00a0</td>\n                    <td>1\u00a0\u2a7d\u00a0<b>T</b>\u00a0\u2a7d\u00a010\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>1\u00a0\u2a7d\u00a0<b>A</b>,\u00a0<b>B</b>,\u00a0<b>C</b>\u00a0\u2a7d\u00a0100\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>\u221210<sup>6</sup>\u00a0\u2a7d\u00a0<b>v</b>\u00a0\u2a7d\u00a010<sup>6</sup>\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>2\u00a0\u2a7d\u00a0<b>N</b>\u00a0\u2a7d\u00a010<sup>5</sup>\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>1\u00a0\u2a7d\u00a0<b>m</b>\u00a0\u2a7d\u00a0<b>M</b>\u00a0\u2a7d\u00a010<sup>6</sup>\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>1\u00a0\u2a7d\u00a0<b>R</b>\u00a0&lt;\u00a0<b>N</b>\n                    </td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n</table>\n<h2 id=\"sec8\" class=\"section\">Output data</h2>\n<p>\n    Write the\u00a0fairest possible division of\u00a0zones into regions for\u00a0each test.\n    Answers to\u00a0the\u00a0tests should be given in\u00a0order corresponding to\u00a0the\u00a0input data.</p>\n<p>Division into regions should consist of\u00a0<b>A</b> \u00b7 <b>B</b> \u00b7 <b>C</b> integers between 1 and\u00a0<b>N</b>,\n    in exactly the\u00a0same format as\u00a0the\u00a0input description of\u00a0single zone values.\n    Zones of\u00a0equal numbers are zones belonging to\u00a0the\u00a0same region.\n    Additionally, the\u00a0last line of the\u00a0division description should include a\u00a0single integer\n    <b>S</b> \u2013 a\u00a0calculated sum of\u00a0all nonnegative differences of\u00a0values of\u00a0adjoining regions plus 1.</p>\n<p>\n    <b>S</b> = 1 + \u2211<sub><b>i</b>=1</sub><sup><b>m</b></sup> | <b>v</b><sub><b>i</b></sub><sup>1</sup> \u2212\n    <b>v</b><sub><b>i</b></sub><sup>2</sup> |, where:\n</p>\n<ul class=\"itemize\">\n    <li class=\"li-itemize\">\n        <b>m</b> is the\u00a0number of all different pairs of\u00a0adjoining regions,\n    </li>\n    <li class=\"li-itemize\"><b>v</b><sub><b>i</b></sub><sup>1</sup> and <b>v</b><sub><b>i</b></sub><sup>2</sup> are\n        the\u00a0values of\u00a0two adjoining regions within <b>i</b><em>-th</em> pair.\n    </li>\n</ul>\n<h2 id=\"sec11\" class=\"section\">Example</h2>\n<p>\n    For the\u00a0input data:\n</p>\n<pre>\n1\n4 3 2\n1 7 2 8\n2 -1 -2 0\n12 9 -1 -10\n-9 1 1 1\n1 2 3 4\n2 2 2 2\n3 6 12 2\n</pre>\n<p>\n    A\u00a0possible correct answer is:\n</p>\n<pre>\n2 1 2 3\n2 2 2 3\n2 1 1 3\n2 1 1 3\n2 2 1 3\n2 1 1 3\n39\n</pre>\n<h2 id=\"sec14\" class=\"section\">Example clarification</h2>\n<p>\n    Cumulated value of\u00a0the region number 1 is 24 (= 7 + 9 + (\u22121) + 1 + 1 + 3 + 2 + 2),\n    the value of\u00a0the region number 2 is 10, and the\u00a0value of\u00a0the region number 3 is 5.\n    All regions adjoin one another, therefore the\u00a0sum of\u00a0differences\n    of values of\u00a0adjoining regions is: <b>S</b> = 1 + |24 \u2212 10| + |24 \u2212 5| + |10 \u2212 5| = 39.</p>\n<h2 id=\"sec16\" class=\"section\">Score</h2>\n<p>\n    If the\u00a0answer is correct, the\u00a0score for\u00a0a\u00a0given set equals <b>1e17 - Q</b> where <b>Q</b> is the\u00a0sum of\u00a0<b>S</b> values from\u00a0all the\u00a0tests.\n    Otherwise the\u00a0score is 0.\n</p>",
    "category_name": "main",
    "user": {
        "username": ""
    },
    "date_added": "26-01-2018",
    "is_direct_submittable": false,
    "contest_name": "Replay of Deadline24 2017 Qualifying Round",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, LISP sbcl, LISP clisp, SCM guile, ERL, TCL, kotlin, TEXT, SCM chicken, FS",
    "todo": false,
    "time": {
        "view_start_date": 1518188400,
        "end_date": 1518199200,
        "practice_submission_allowed": true,
        "visible_start_date": 1518199200,
        "submit_start_date": 1518188400,
        "current": 1537433039
    },
    "problem_author_html_handle": "deadline24",
    "problem_name": "Legacy",
    "source_sizelimit": "50000",
    "tags": "<a class='problem-tag-small ' href='/tags/problems/deadline24'>deadline24</a>",
    "problem_tester_html_handle": "",
    "problem_author": "deadline24",
    "contest_code": "DEAD2018",
    "max_timelimit": "10",
    "problem_code": "DL2017D"
}