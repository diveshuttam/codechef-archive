{
    "status": "success",
    "problem_status": "unattempted",
    "problem_tester": null,
    "body": "<span class=\"solution-visible-txt\">All submissions for this problem are available.</span><h2 id=\"sec1\" class=\"section\">Introduction</h2>\n<p>\n    The military personnel of\u00a0the 1<sup><span>st</span></sup>\u00a0Company 2<sup><span>nd</span></sup>\u00a0Battalion 3<sup><span>rd</span></sup>\u00a0Regiment\n    5<sup><span>th</span></sup>\u00a0Brigade\n    8<sup><span>th</span></sup>\u00a0Division 13<sup><span>th</span></sup>\u00a0Corps 21<sup><span>st</span></sup>\u00a0Army of\u00a0the\n    34<sup><span>th</span></sup>\u00a0Front\n    of the\u00a0Great Stark Rim lodging in\u00a0the barracks have fallen into sluggishness and lethargy. Despite being an\u00a0elite\n    military unit\n    they have been stuck as a\u00a0reserve for\u00a0months, not only deprived of\u00a0any possibility to\u00a0show their skills, but also\n    of\u00a0any activity apart\n    from the\u00a0endurance exercises and firearms practice, repeated ad nauseam, obstacles rearranged unexpectedly being\n    the\u00a0only variation.</p>\n<p>After another routine inspection Master Major Gnat for\u00a0beetle security, the\u00a02<sup><span>nd</span></sup>\u00a0Battalion\n    morale officer, fell into a\u00a0pensive mood.\n    <em>,,This state of\u00a0affairs is unacceptable\u201d</em> \u2013 he thought \u2013 <em>,,they will surely become completely\n        demoralized\u201d</em>\n    and started wringing his limbs.\n    As a\u00a0veteran of\u00a0many a\u00a0battle for\u00a0soldiers\u2019 morale, he knew that he had to\u00a0act quickly, before the\u00a0damage became\n    irreversible.\n    When he was considering his options, a\u00a0crossword in\u00a0the ,,Beetlejournal\u201d magazine captured his attention. <em>,,That\u2019s\u00a0it.\n        Orderly \u2013 report!\u201d</em></p>\n<p>A few moments later the\u00a0company\u2019s schedule was rewritten. Soldiers, divided into temporary groups, received a\u00a0task \u2013\n    prepare the\u00a0best,\n    the most complicated and highest scored crossword! To\u00a0further complicate matters \u2013 in\u00a0a few local, rather\n    idiosyncratic dialects.\n    Dictionaries have been prepared and made available, rules have been established \u2013 ready, steady, go!</p>\n<h2 id=\"sec3\" class=\"section\">What\u2019s going on, or a\u00a0private\u2019s perspective</h2>\n<p>\n    Each group receives an\u00a0identical data set consisting of:</p>\n<ul class=\"itemize\">\n    <li class=\"li-itemize\">\n        dictionaries, one of\u00a0each dialect,\n    </li>\n    <li class=\"li-itemize\">a\u00a0board on which they will be working; premium squares are marked on the\u00a0board,\n    </li>\n    <li class=\"li-itemize\">information concerning the\u00a0value of\u00a0each letter within the\u00a0overall score,\n    </li>\n    <li class=\"li-itemize\">a\u00a0sequence of\u00a0letters \u2013 made available gradually \u2013 in\u00a0the order they can be used,\n    </li>\n    <li class=\"li-itemize\">the\u00a0size of\u00a0the letter pool that can be used at a\u00a0given moment.\n    </li>\n</ul>\n<p>A note is attached to\u00a0all of\u00a0the above explaining the\u00a0board and additional\n    rules: <em>,,Note! Premium letter squares multiply the\u00a0score\n        of a\u00a0letter that is placed on them, premium word squares multiply the\u00a0score\n        for the\u00a0entire word including the\u00a0letters previously placed on the\u00a0board.\n        Keep in\u00a0mind that each premium square is like a\u00a0landmine \u2013 works only once,\n        when you\u2019re placing a\u00a0letter on it! Furthermore, bear in\u00a0mind that letter\n        premiums are counted before word premiums!\u201d</em>.</p>\n<p>There is an\u00a0additional note in\u00a0smaller print below: <em>,,By personal\n    recommendation of\u00a0Major Bone: First word may be placed wherever on the\u00a0board.\n    All the\u00a0following words must intersect the\u00a0ones already on the\u00a0board.\n    Forming more than one word at a\u00a0time complicates the\u00a0work of\u00a0an officer\n    in an\u00a0unacceptable way! Each turn may result in\u00a0just one word,\n    a turn when more than one word is formed will be regarded as the\u00a0grounds\n    for rejecting such a\u00a0solution and executing the\u00a0soldier presenting such a\u00a0thing!\u201d</em>.</p>\n<p>The Major is focused on achieving goals he sets for\u00a0himself (and not only himself). Therefore he expects\n    each team to\u00a0deliver a\u00a0crossword. The\u00a0best ones can count on\u00a0being given the\u00a0most interesting firing courses\n    and maybe even \u2013 attention \u2013 to\u00a0be relocated to\u00a0front-line units!</p>\n<h2 id=\"sec5\" class=\"section\">Problem</h2>\n<p>\n    As a\u00a0soldier involved in\u00a0the Major\u2019s plan you create a\u00a0crossword in\u00a0an unknown language written\n    in a\u00a0not necessarily logical alphabet, on a\u00a0board you\u2019ve only just been shown,\n    using a\u00a0limited letter pool, to\u00a0which you don\u2019t always have full access. Good luck.</p>\n\n\n<h2 id=\"sec7\" class=\"section\">Input data</h2>\n<p>\n    The\u00a0first line of\u00a0the test set includes one integer <b>W</b> denoting the\u00a0number of\u00a0dictionaries.\n    The following lines list content of those dictionaries.\n</p>\n<p>\n    The first line of the description of a dictionary contains one integer <b>Z</b> denoting the number of words in this dictionary.\n    The following <b>Z</b> lines contain words from the dictionary, so that each line contains exactly one word.\n    Single word consists of maximum 50 characters from latin alphabet, both lower and upper case.\n</p>\n<p>\n    The\u00a0next line, after all dictionaries, includes one integer <b>T</b> denoting the\u00a0number of\u00a0tests.\n    The following lines include descriptions of\u00a0tests.</p>\n<p>The\u00a0first line of\u00a0the description includes one natural number <b>D</b> denoting\n    the number of\u00a0a dictionary you should use (1 for the first dictionary, 2 for the second and so on). Second line of\u00a0the\n    test set contains two natural numbers <b>M</b> and <b>N</b> denoting the\u00a0board dimensions.</p>\n<p>The following <b>N</b> lines include <b>M</b> <b>P</b><sub><b>i</b>,<b>j</b></sub> characters each.\n    Each of\u00a0the characters denotes one board square with coordinates (<b>i</b>,<b>j</b>)\n    and can take one of\u00a0the following values:</p>\n<ul class=\"itemize\">\n    <li class=\"li-itemize\">\n        \u2019<tt>.</tt>\u2019 \u2013 denotes an\u00a0ordinary field,\n    </li>\n    <li class=\"li-itemize\">\u2019<tt>2</tt>\u2019 \u2013 denotes a\u00a0field multiplying the\u00a0score of\u00a0the letter placed on it by\u00a02,\n    </li>\n    <li class=\"li-itemize\">\u2019<tt>3</tt>\u2019 \u2013 denotes a\u00a0field multiplying the\u00a0score of\u00a0the letter placed on it by\u00a03,\n    </li>\n    <li class=\"li-itemize\">\u2019<tt>x</tt>\u2019 \u2013 denotes a\u00a0field multiplying the\u00a0score of\u00a0the word containing the\u00a0letter\n        placed on it by\u00a02,\n    </li>\n    <li class=\"li-itemize\">\u2019<tt>X</tt>\u2019 \u2013 denotes a\u00a0field multiplying the\u00a0score of\u00a0the word containing the\u00a0letter\n        placed on it by\u00a03.\n    </li>\n</ul>\n<p>The next line contains one integer <b>L</b> denoting the\u00a0number of\u00a0letters in\u00a0the alphabet of\u00a0the dialect used at\n    the\u00a0time.</p>\n<p>The following line includes <b>L</b> pairs (<b>C</b>, <b>V</b>), where <b>C</b> denotes\n    the letter of\u00a0the alphabet and <b>V</b> is the\u00a0score of\u00a0the letter expressed as an\u00a0integer.\n    Each letter <b>C</b> can be one of\u00a0the letters of\u00a0the Latin alphabet.\n    There is a\u00a0distinction between small and capital letters\n    (<b>C</b> \u2208 {<tt>a</tt>, <tt>b</tt>, <tt>c</tt>, \u2026, <tt>z</tt>, <tt>A</tt>, <tt>B</tt>,\n    <tt>C</tt>, \u2026, <tt>Z</tt>} ).</p>\n<p>The line following after that includes two integers <b>B</b> and <b>Q</b> separated with a\u00a0single space.\n    <b>B</b> denotes the\u00a0length of\u00a0a letter buffer the\u00a0crossword maker can use,\n    <b>Q</b> is the\u00a0overall number of\u00a0letters available for\u00a0the\u00a0maker.</p>\n<p>The subsequent line contains exactly <b>Q</b> letters of\u00a0the alphabet described earlier.\n    It is a\u00a0sequence of\u00a0elements that will find their way into\n    the buffer gradually and in\u00a0batches, as the\u00a0letters available in\u00a0it are used.</p>\n\n            <table class=\"cellpading0\">\n                <tr>\n                    <td>\u00a0</td>\n                    <td>1\u00a0\u2a7d\u00a0<b>W</b>\u00a0\u2a7d\u00a010\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>1\u00a0\u2a7d\u00a0<b>Z</b>\u00a0\u2a7d\u00a0200000\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>1\u00a0\u2a7d\u00a0<b>T</b>\u00a0\u2a7d\u00a010\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>1\u00a0\u2a7d\u00a0<b>D</b>\u00a0\u2a7d\u00a05\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>5\u00a0\u2a7d\u00a0<b>M</b>,\u00a0<b>N</b>\u00a0\u2a7d\u00a050\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>1\u00a0\u2a7d\u00a0<b>i</b>\u00a0\u2a7d\u00a0<b>M</b>\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>1\u00a0\u2a7d\u00a0<b>j</b>\u00a0\u2a7d\u00a0<b>N</b>\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>\n                        <b>P</b><sub><b>i</b>,<b>j</b></sub>\u00a0\u2208\u00a0{<span>.</span>,\u00a0<span>2</span>,\u00a0<span>3</span>,\u00a0<span>x</span>,\u00a0<span>X</span>}\u00a0\n                    </td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>5\u00a0\u2a7d\u00a0<b>L</b>\u00a0\u2a7d\u00a052\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>0\u00a0\u2a7d\u00a0<b>V</b>\u00a0\u2a7d\u00a010\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>3\u00a0\u2a7d\u00a0<b>B</b>\u00a0\u2a7d\u00a0<b>Q</b>\u00a0</td>\n                </tr>\n                <tr>\n                    <td>\u00a0</td>\n                    <td>10\u00a0\u2a7d\u00a0<b>Q</b>\u00a0\u2a7d\u00a0<b>M</b>\u00b7\u00a0<b>N</b>\u00a0</td>\n                </tr>\n            </table><p></p>\n\n<h2 id=\"sec10\" class=\"section\">Output data</h2>\n<p>\n    Write a\u00a0description of\u00a0the crossword making for\u00a0each test. Descriptions\n    should be given in\u00a0order corresponding to\u00a0the\u00a0input data.</p>\n<p>The\u00a0first line of\u00a0each description should contain two natural numbers separated\n    with a\u00a0single space: <b>W</b>\u00a0denoting the\u00a0number of\u00a0words formed\n    and <b>S</b> denoting the\u00a0score obtained during crossword making.</p>\n<p>Each of\u00a0the next <b>W</b> lines of\u00a0the description should include\n    four consecutive items: coordinates (horizontal and vertical)\n    of the\u00a0first letter of\u00a0a formed word, a\u00a0formed word, and orientation:\n    \u2019<b>H</b>\u2019 for\u00a0the\u00a0horizontal coordinate or\u00a0\u2019<b>V</b>\u2019 for\u00a0the\u00a0vertical one.</p>\n    \n<h2 id=\"sec12\" class=\"section\">Example</h2>\n<p>\n    For the\u00a0input data:\n</p>\n<pre><code>1\n9\nclue\ngo\nhOpeful\ninput\noptiMal\nSolvE\nSolvEr\ntrUth\nUniverSum\n1\n1\n12 9\n............\n..2......3..\n............\n.......x....\n............\n....X..2....\n............\n..3......2..\n............\n22\na 1 b 1 c 2 e 2 f 1 g 1 h 1 i 3 l 2 m 1 n 2 o 3 p 3 r 3 t 1 u 4 v 3 E 3 M 2 O 3 S 4 U 5\n9 42\nmoStUhtfrliMapvucebunirgEepuolvbOMtinSutir\n</code></pre>\n<p></p>\n\n<p>\n    A\u00a0possible correct answer is:\n</p>\n\n<pre><code>9 201\n3 2 trUth V\n1 2 optiMal H\n7 1 clue V\n3 4 UniverSum H\n1 1 go V\n9 4 SolvE V\n3 6 hOpeful H\n5 4 input V\n9 4 SolvEr V\n</code></pre>\n<p></p>\n\n<h2 id=\"sec15\" class=\"section\">Example clarification</h2>\n\n    <div class=\"minipage\">\n        <p>\n            In the\u00a0first step the\u00a0letters we have in\u00a0the buffer are: <tt>moStUhtfr</tt>.\n            From them we form the\u00a0word <tt>trUth</tt> (each word must be a\u00a0part of\u00a0the\u00a0dictionary number 5\n            \u2013 the\u00a0dictionary is extensive and is not shown in\u00a0the example).\n            After this operation, 4 letters (<tt>moSf</tt>) would remain and another five letters would be added\n            to\u00a0the\u00a0buffer that would then look like this: <tt>moSfliMap</tt>.\n        </p>\n        <p>\n            This allows for\u00a0the\u00a0word <tt>optiMal</tt> to\u00a0be formed, as one of\u00a0the letters\n            (\u2019<tt>t</tt>\u2019 \u2013 underlined in\u00a0Table\u00a0<a href=\"#steps\">1</a>)\n            will be shared with the\u00a0letters already on the\u00a0board.\n            The buffer will again be filled\u00a0up with 9\u00a0letters and will contain the\u00a0following 9\u00a0characters: <tt>mSfvucebu</tt>.\n        </p></div>\n\n    <pre><code>g.....c.....\noptiMal.....\n..r...u.....\n..UniverSum.\n..t.n...o...\n..hOpeful...\n....u...v...\n....t...E...\n........r...\n</code></pre>\n\n\n<p>Using the\u00a0letter \u2019<tt>l</tt>\u2019 on the\u00a0board we form the\u00a0word <tt>clue</tt>.\n    The contents of\u00a0the buffer will be altered to: <tt>mSfvbunir</tt>. Another word \u2013 <tt>UniverSum</tt> \u2013\n    will contain seven letters from\u00a0the buffer and two letters already on the\u00a0board (letters: \u2019<tt>U</tt>\u2019 and\n    \u2019<tt>e</tt>\u2019), and so on.</p>\n    \n<p>The remaining words are formed analogically. The\u00a0contents of\u00a0the buffer at individual stages,\n    words formed and scores given for\u00a0them are shown in\u00a0Table\u00a0<a href=\"#steps\">1</a>.</p>\n    \n<p>The score <tt>S</tt> for\u00a0the\u00a0entire crossword equals therefore: 12 + 15 + 10 + 54 + 4 + 15 + 60 + 13 + 18 = 201.\n</p>\n\n<blockquote class=\"table\">\n    <div class=\"center\">\n        <div class=\"center\">\n            <hr>\n        </div>\n        <div class=\"caption\">\n            <table class=\"cellpading0\">\n                <tr>\n                    <td>Table 1: Example \u2013 consecutive steps of\u00a0crossword making and the\u00a0scores.</td>\n                </tr>\n            </table>\n        </div>\n        <a id=\"steps\"></a>\n\n        <table class=\"cellpading0\">\n            <tr>\n                <td>Buffer</td>\n                <td>Word</td>\n                <td>Score</td>\n            </tr>\n            <tr>\n                <td><tt>moStUhtfr</tt></td>\n                <td><tt>trUth</tt></td>\n                <td>12 = 2\u00b71+3+5+1+1</td>\n            </tr>\n            <tr>\n                <td><tt>moSfliMap</tt></td>\n                <td><tt>op</tt><u>t</u><tt>iMal</tt></td>\n                <td>15 = 3+3+1+3+2+1+2</td>\n            </tr>\n            <tr>\n                <td><tt>mSfvucebu</tt></td>\n                <td><tt>c</tt><u>l</u><tt>ue</tt></td>\n                <td>10 = 2+2+4+2</td>\n            </tr>\n            <tr>\n                <td><tt>mSfvbunir</tt></td>\n                <td><u>U</u><tt>niv</tt><u>e</u><tt>rSum</tt></td>\n                <td>54 = 2\u00b7(5+2+3+3+2+3+4+4+1)</td>\n            </tr>\n            <tr>\n                <td><tt>fbgEepuol</tt></td>\n                <td><tt>g</tt><u>o</u></td>\n                <td>4 = 1+3</td>\n            </tr>\n            <tr>\n                <td><tt>fbEepuolv</tt></td>\n                <td><u>S</u><tt>olvE</tt></td>\n                <td>15 = 4+3+2+3+3</td>\n            </tr>\n            <tr>\n                <td><tt>fbepubOMt</tt></td>\n                <td><u>h</u><tt>Opefu</tt><u>l</u></td>\n                <td>60 = 3\u00b7(1+3+3+2+1+2\u00b74+2)</td>\n            </tr>\n            <tr>\n                <td><tt>bbMtinSut</tt></td>\n                <td><u>i</u><tt>n</tt><u>p</u><tt>ut</tt></td>\n                <td>13 = 3+2+3+4+1</td>\n            </tr>\n            <tr>\n                <td><tt>bbMtiSir</tt></td>\n                <td><u>SolvE</u><tt>r</tt></td>\n                <td>18 = 4+3+2+3+3+3</td>\n            </tr>\n        </table>\n        <div class=\"center\">\n            <hr>\n        </div>\n    </div>\n</blockquote>\n<h2 id=\"sec18\" class=\"section\">Score</h2>\n<p>\n    If the\u00a0following conditions are satisfied for\u00a0each test:\n</p>\n<ul class=\"itemize\">\n    <li class=\"li-itemize\">\n        output data is in\u00a0the correct format,\n    </li>\n    <li class=\"li-itemize\">each consecutive word added to\u00a0the\u00a0crossword (apart from\u00a0the first one) has\n        at least one letter shared with the\u00a0words already on the\u00a0board,\n    </li>\n    <li class=\"li-itemize\">adding a\u00a0new word each time creates a\u00a0correct crossword (compliant with the\u00a0Major\u2019s\n        guidelines),\n    </li>\n    <li class=\"li-itemize\">the\u00a0score for\u00a0the\u00a0crossword is correctly calculated,\n    </li>\n</ul>\n<p>\n    the score for\u00a0a\u00a0given set equals the\u00a0sum of\u00a0<span>S</span> values from\u00a0all the\u00a0tests. Otherwise the\u00a0score is 0.</p>\n",
    "category_name": "main",
    "user": {
        "username": ""
    },
    "date_added": "25-01-2018",
    "is_direct_submittable": false,
    "contest_name": "Replay of Deadline24 2017 Qualifying Round",
    "languages_supported": "C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, LISP sbcl, LISP clisp, SCM guile, ERL, TCL, kotlin, TEXT, SCM chicken, FS",
    "todo": false,
    "time": {
        "view_start_date": 1518188400,
        "end_date": 1518199200,
        "practice_submission_allowed": true,
        "visible_start_date": 1518199200,
        "submit_start_date": 1518188400,
        "current": 1537433043
    },
    "problem_author_html_handle": "deadline24",
    "problem_name": "Crossword",
    "source_sizelimit": "50000",
    "tags": "<a class='problem-tag-small ' href='/tags/problems/deadline24'>deadline24</a>",
    "problem_tester_html_handle": "",
    "problem_author": "deadline24",
    "contest_code": "DEAD2018",
    "max_timelimit": "15 - 60",
    "problem_code": "DL2017C"
}